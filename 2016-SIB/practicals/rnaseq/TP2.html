<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta http-equiv="Content-Style-Type" content="text/css" />
  <meta name="generator" content="pandoc" />
  <title></title>
  <style type="text/css">code{white-space: pre;}</style>
  <style type="text/css">
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; }
code > span.dt { color: #902000; }
code > span.dv { color: #40a070; }
code > span.bn { color: #40a070; }
code > span.fl { color: #40a070; }
code > span.ch { color: #4070a0; }
code > span.st { color: #4070a0; }
code > span.co { color: #60a0b0; font-style: italic; }
code > span.ot { color: #007020; }
code > span.al { color: #ff0000; font-weight: bold; }
code > span.fu { color: #06287e; }
code > span.er { color: #ff0000; font-weight: bold; }
  </style>
  <link href="data:text/css,%2F%2A%21%20normalize%2Ecss%20v2%2E1%2E3%20%7C%20MIT%20License%20%7C%20git%2Eio%2Fnormalize%20%2A%2F%0A%0A%2F%2A%20source%3A%20https%3A%2F%2Fgist%2Egithubusercontent%2Ecom%2Fdashed%2F6714393%2Fraw%2Fae966d9d0806eb1e24462d88082a0264438adc50%2Fgithub%2Dpandoc%2Ecss%20%2A%2F%0A%0A%2F%2A%20%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%0A%20%20%20HTML5%20display%20definitions%0A%20%20%20%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%20%2A%2F%0A%0A%2F%2A%2A%0A%20%2A%20Correct%20%60block%60%20display%20not%20defined%20in%20IE%208%2F9%2E%0A%20%2A%2F%0A%0Aarticle%2C%0Aaside%2C%0Adetails%2C%0Afigcaption%2C%0Afigure%2C%0Afooter%2C%0Aheader%2C%0Ahgroup%2C%0Amain%2C%0Anav%2C%0Asection%2C%0Asummary%20%7B%0A%20%20%20%20display%3A%20block%3B%0A%7D%0A%0A%2F%2A%2A%0A%20%2A%20Correct%20%60inline%2Dblock%60%20display%20not%20defined%20in%20IE%208%2F9%2E%0A%20%2A%2F%0A%0Aaudio%2C%0Acanvas%2C%0Avideo%20%7B%0A%20%20%20%20display%3A%20inline%2Dblock%3B%0A%7D%0A%0A%2F%2A%2A%0A%20%2A%20Prevent%20modern%20browsers%20from%20displaying%20%60audio%60%20without%20controls%2E%0A%20%2A%20Remove%20excess%20height%20in%20iOS%205%20devices%2E%0A%20%2A%2F%0A%0Aaudio%3Anot%28%5Bcontrols%5D%29%20%7B%0A%20%20%20%20display%3A%20none%3B%0A%20%20%20%20height%3A%200%3B%0A%7D%0A%0A%2F%2A%2A%0A%20%2A%20Address%20%60%5Bhidden%5D%60%20styling%20not%20present%20in%20IE%208%2F9%2E%0A%20%2A%20Hide%20the%20%60template%60%20element%20in%20IE%2C%20Safari%2C%20and%20Firefox%20%3C%2022%2E%0A%20%2A%2F%0A%0A%5Bhidden%5D%2C%0Atemplate%20%7B%0A%20%20%20%20display%3A%20none%3B%0A%7D%0A%0A%2F%2A%20%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%0A%20%20%20Base%0A%20%20%20%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%20%2A%2F%0A%0A%2F%2A%2A%0A%20%2A%201%2E%20Set%20default%20font%20family%20to%20sans%2Dserif%2E%0A%20%2A%202%2E%20Prevent%20iOS%20text%20size%20adjust%20after%20orientation%20change%2C%20without%20disabling%0A%20%2A%20%20%20%20user%20zoom%2E%0A%20%2A%2F%0A%0Ahtml%20%7B%0A%20%20%20%20font%2Dfamily%3A%20sans%2Dserif%3B%20%2F%2A%201%20%2A%2F%0A%20%20%20%20%2Dms%2Dtext%2Dsize%2Dadjust%3A%20100%25%3B%20%2F%2A%202%20%2A%2F%0A%20%20%20%20%2Dwebkit%2Dtext%2Dsize%2Dadjust%3A%20100%25%3B%20%2F%2A%202%20%2A%2F%0A%7D%0A%0A%2F%2A%2A%0A%20%2A%20Remove%20default%20margin%2E%0A%20%2A%2F%0A%0Abody%20%7B%0A%20%20%20%20margin%3A%200%3B%0A%7D%0A%0A%2F%2A%20%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%0A%20%20%20Links%0A%20%20%20%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%20%2A%2F%0A%0A%2F%2A%2A%0A%20%2A%20Remove%20the%20gray%20background%20color%20from%20active%20links%20in%20IE%2010%2E%0A%20%2A%2F%0A%0Aa%20%7B%0A%20%20%20%20background%3A%20transparent%3B%0A%7D%0A%0A%2F%2A%2A%0A%20%2A%20Address%20%60outline%60%20inconsistency%20between%20Chrome%20and%20other%20browsers%2E%0A%20%2A%2F%0A%0Aa%3Afocus%20%7B%0A%20%20%20%20outline%3A%20thin%20dotted%3B%0A%7D%0A%0A%2F%2A%2A%0A%20%2A%20Improve%20readability%20when%20focused%20and%20also%20mouse%20hovered%20in%20all%20browsers%2E%0A%20%2A%2F%0A%0Aa%3Aactive%2C%0Aa%3Ahover%20%7B%0A%20%20%20%20outline%3A%200%3B%0A%7D%0A%0A%2F%2A%20%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%0A%20%20%20Typography%0A%20%20%20%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%20%2A%2F%0A%0A%2F%2A%2A%0A%20%2A%20Address%20variable%20%60h1%60%20font%2Dsize%20and%20margin%20within%20%60section%60%20and%20%60article%60%0A%20%2A%20contexts%20in%20Firefox%204%2B%2C%20Safari%205%2C%20and%20Chrome%2E%0A%20%2A%2F%0A%0Ah1%20%7B%0A%20%20%20%20font%2Dsize%3A%202em%3B%0A%20%20%20%20margin%3A%200%2E67em%200%3B%0A%7D%0A%0A%2F%2A%2A%0A%20%2A%20Address%20styling%20not%20present%20in%20IE%208%2F9%2C%20Safari%205%2C%20and%20Chrome%2E%0A%20%2A%2F%0A%0Aabbr%5Btitle%5D%20%7B%0A%20%20%20%20border%2Dbottom%3A%201px%20dotted%3B%0A%7D%0A%0A%2F%2A%2A%0A%20%2A%20Address%20style%20set%20to%20%60bolder%60%20in%20Firefox%204%2B%2C%20Safari%205%2C%20and%20Chrome%2E%0A%20%2A%2F%0A%0Ab%2C%0Astrong%20%7B%0A%20%20%20%20font%2Dweight%3A%20bold%3B%0A%7D%0A%0A%2F%2A%2A%0A%20%2A%20Address%20styling%20not%20present%20in%20Safari%205%20and%20Chrome%2E%0A%20%2A%2F%0A%0Adfn%20%7B%0A%20%20%20%20font%2Dstyle%3A%20italic%3B%0A%7D%0A%0A%2F%2A%2A%0A%20%2A%20Address%20differences%20between%20Firefox%20and%20other%20browsers%2E%0A%20%2A%2F%0A%0Ahr%20%7B%0A%20%20%20%20%2Dmoz%2Dbox%2Dsizing%3A%20content%2Dbox%3B%0A%20%20%20%20box%2Dsizing%3A%20content%2Dbox%3B%0A%20%20%20%20height%3A%200%3B%0A%7D%0A%0A%2F%2A%2A%0A%20%2A%20Address%20styling%20not%20present%20in%20IE%208%2F9%2E%0A%20%2A%2F%0A%0Amark%20%7B%0A%20%20%20%20background%3A%20%23ff0%3B%0A%20%20%20%20color%3A%20%23000%3B%0A%7D%0A%0A%2F%2A%2A%0A%20%2A%20Correct%20font%20family%20set%20oddly%20in%20Safari%205%20and%20Chrome%2E%0A%20%2A%2F%0A%0Acode%2C%0Akbd%2C%0Apre%2C%0Asamp%20%7B%0A%20%20%20%20font%2Dfamily%3A%20monospace%2C%20serif%3B%0A%20%20%20%20font%2Dsize%3A%201em%3B%0A%7D%0A%0A%2F%2A%2A%0A%20%2A%20Improve%20readability%20of%20pre%2Dformatted%20text%20in%20all%20browsers%2E%0A%20%2A%2F%0A%0Apre%20%7B%0A%20%20%20%20white%2Dspace%3A%20pre%2Dwrap%3B%0A%7D%0A%0A%2F%2A%2A%0A%20%2A%20Set%20consistent%20quote%20types%2E%0A%20%2A%2F%0A%0Aq%20%7B%0A%20%20%20%20quotes%3A%20%22%5C201C%22%20%22%5C201D%22%20%22%5C2018%22%20%22%5C2019%22%3B%0A%7D%0A%0A%2F%2A%2A%0A%20%2A%20Address%20inconsistent%20and%20variable%20font%20size%20in%20all%20browsers%2E%0A%20%2A%2F%0A%0Asmall%20%7B%0A%20%20%20%20font%2Dsize%3A%2080%25%3B%0A%7D%0A%0A%2F%2A%2A%0A%20%2A%20Prevent%20%60sub%60%20and%20%60sup%60%20affecting%20%60line%2Dheight%60%20in%20all%20browsers%2E%0A%20%2A%2F%0A%0Asub%2C%0Asup%20%7B%0A%20%20%20%20font%2Dsize%3A%2075%25%3B%0A%20%20%20%20line%2Dheight%3A%200%3B%0A%20%20%20%20position%3A%20relative%3B%0A%20%20%20%20vertical%2Dalign%3A%20baseline%3B%0A%7D%0A%0Asup%20%7B%0A%20%20%20%20top%3A%20%2D0%2E5em%3B%0A%7D%0A%0Asub%20%7B%0A%20%20%20%20bottom%3A%20%2D0%2E25em%3B%0A%7D%0A%0A%2F%2A%20%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%0A%20%20%20Embedded%20content%0A%20%20%20%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%20%2A%2F%0A%0A%2F%2A%2A%0A%20%2A%20Remove%20border%20when%20inside%20%60a%60%20element%20in%20IE%208%2F9%2E%0A%20%2A%2F%0A%0Aimg%20%7B%0A%20%20%20%20border%3A%200%3B%0A%7D%0A%0A%2F%2A%2A%0A%20%2A%20Correct%20overflow%20displayed%20oddly%20in%20IE%209%2E%0A%20%2A%2F%0A%0Asvg%3Anot%28%3Aroot%29%20%7B%0A%20%20%20%20overflow%3A%20hidden%3B%0A%7D%0A%0A%2F%2A%20%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%0A%20%20%20Figures%0A%20%20%20%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%20%2A%2F%0A%0A%2F%2A%2A%0A%20%2A%20Address%20margin%20not%20present%20in%20IE%208%2F9%20and%20Safari%205%2E%0A%20%2A%2F%0A%0Afigure%20%7B%0A%20%20%20%20margin%3A%200%3B%0A%7D%0A%0A%2F%2A%20%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%0A%20%20%20Forms%0A%20%20%20%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%20%2A%2F%0A%0A%2F%2A%2A%0A%20%2A%20Define%20consistent%20border%2C%20margin%2C%20and%20padding%2E%0A%20%2A%2F%0A%0Afieldset%20%7B%0A%20%20%20%20border%3A%201px%20solid%20%23c0c0c0%3B%0A%20%20%20%20margin%3A%200%202px%3B%0A%20%20%20%20padding%3A%200%2E35em%200%2E625em%200%2E75em%3B%0A%7D%0A%0A%2F%2A%2A%0A%20%2A%201%2E%20Correct%20%60color%60%20not%20being%20inherited%20in%20IE%208%2F9%2E%0A%20%2A%202%2E%20Remove%20padding%20so%20people%20aren%27t%20caught%20out%20if%20they%20zero%20out%20fieldsets%2E%0A%20%2A%2F%0A%0Alegend%20%7B%0A%20%20%20%20border%3A%200%3B%20%2F%2A%201%20%2A%2F%0A%20%20%20%20padding%3A%200%3B%20%2F%2A%202%20%2A%2F%0A%7D%0A%0A%2F%2A%2A%0A%20%2A%201%2E%20Correct%20font%20family%20not%20being%20inherited%20in%20all%20browsers%2E%0A%20%2A%202%2E%20Correct%20font%20size%20not%20being%20inherited%20in%20all%20browsers%2E%0A%20%2A%203%2E%20Address%20margins%20set%20differently%20in%20Firefox%204%2B%2C%20Safari%205%2C%20and%20Chrome%2E%0A%20%2A%2F%0A%0Abutton%2C%0Ainput%2C%0Aselect%2C%0Atextarea%20%7B%0A%20%20%20%20font%2Dfamily%3A%20inherit%3B%20%2F%2A%201%20%2A%2F%0A%20%20%20%20font%2Dsize%3A%20100%25%3B%20%2F%2A%202%20%2A%2F%0A%20%20%20%20margin%3A%200%3B%20%2F%2A%203%20%2A%2F%0A%7D%0A%0A%2F%2A%2A%0A%20%2A%20Address%20Firefox%204%2B%20setting%20%60line%2Dheight%60%20on%20%60input%60%20using%20%60%21important%60%20in%0A%20%2A%20the%20UA%20stylesheet%2E%0A%20%2A%2F%0A%0Abutton%2C%0Ainput%20%7B%0A%20%20%20%20line%2Dheight%3A%20normal%3B%0A%7D%0A%0A%2F%2A%2A%0A%20%2A%20Address%20inconsistent%20%60text%2Dtransform%60%20inheritance%20for%20%60button%60%20and%20%60select%60%2E%0A%20%2A%20All%20other%20form%20control%20elements%20do%20not%20inherit%20%60text%2Dtransform%60%20values%2E%0A%20%2A%20Correct%20%60button%60%20style%20inheritance%20in%20Chrome%2C%20Safari%205%2B%2C%20and%20IE%208%2B%2E%0A%20%2A%20Correct%20%60select%60%20style%20inheritance%20in%20Firefox%204%2B%20and%20Opera%2E%0A%20%2A%2F%0A%0Abutton%2C%0Aselect%20%7B%0A%20%20%20%20text%2Dtransform%3A%20none%3B%0A%7D%0A%0A%2F%2A%2A%0A%20%2A%201%2E%20Avoid%20the%20WebKit%20bug%20in%20Android%204%2E0%2E%2A%20where%20%282%29%20destroys%20native%20%60audio%60%0A%20%2A%20%20%20%20and%20%60video%60%20controls%2E%0A%20%2A%202%2E%20Correct%20inability%20to%20style%20clickable%20%60input%60%20types%20in%20iOS%2E%0A%20%2A%203%2E%20Improve%20usability%20and%20consistency%20of%20cursor%20style%20between%20image%2Dtype%0A%20%2A%20%20%20%20%60input%60%20and%20others%2E%0A%20%2A%2F%0A%0Abutton%2C%0Ahtml%20input%5Btype%3D%22button%22%5D%2C%20%2F%2A%201%20%2A%2F%0Ainput%5Btype%3D%22reset%22%5D%2C%0Ainput%5Btype%3D%22submit%22%5D%20%7B%0A%20%20%20%20%2Dwebkit%2Dappearance%3A%20button%3B%20%2F%2A%202%20%2A%2F%0A%20%20%20%20cursor%3A%20pointer%3B%20%2F%2A%203%20%2A%2F%0A%7D%0A%0A%2F%2A%2A%0A%20%2A%20Re%2Dset%20default%20cursor%20for%20disabled%20elements%2E%0A%20%2A%2F%0A%0Abutton%5Bdisabled%5D%2C%0Ahtml%20input%5Bdisabled%5D%20%7B%0A%20%20%20%20cursor%3A%20default%3B%0A%7D%0A%0A%2F%2A%2A%0A%20%2A%201%2E%20Address%20box%20sizing%20set%20to%20%60content%2Dbox%60%20in%20IE%208%2F9%2F10%2E%0A%20%2A%202%2E%20Remove%20excess%20padding%20in%20IE%208%2F9%2F10%2E%0A%20%2A%2F%0A%0Ainput%5Btype%3D%22checkbox%22%5D%2C%0Ainput%5Btype%3D%22radio%22%5D%20%7B%0A%20%20%20%20box%2Dsizing%3A%20border%2Dbox%3B%20%2F%2A%201%20%2A%2F%0A%20%20%20%20padding%3A%200%3B%20%2F%2A%202%20%2A%2F%0A%7D%0A%0A%2F%2A%2A%0A%20%2A%201%2E%20Address%20%60appearance%60%20set%20to%20%60searchfield%60%20in%20Safari%205%20and%20Chrome%2E%0A%20%2A%202%2E%20Address%20%60box%2Dsizing%60%20set%20to%20%60border%2Dbox%60%20in%20Safari%205%20and%20Chrome%0A%20%2A%20%20%20%20%28include%20%60%2Dmoz%60%20to%20future%2Dproof%29%2E%0A%20%2A%2F%0A%0Ainput%5Btype%3D%22search%22%5D%20%7B%0A%20%20%20%20%2Dwebkit%2Dappearance%3A%20textfield%3B%20%2F%2A%201%20%2A%2F%0A%20%20%20%20%2Dmoz%2Dbox%2Dsizing%3A%20content%2Dbox%3B%0A%20%20%20%20%2Dwebkit%2Dbox%2Dsizing%3A%20content%2Dbox%3B%20%2F%2A%202%20%2A%2F%0A%20%20%20%20box%2Dsizing%3A%20content%2Dbox%3B%0A%7D%0A%0A%2F%2A%2A%0A%20%2A%20Remove%20inner%20padding%20and%20search%20cancel%20button%20in%20Safari%205%20and%20Chrome%0A%20%2A%20on%20OS%20X%2E%0A%20%2A%2F%0A%0Ainput%5Btype%3D%22search%22%5D%3A%3A%2Dwebkit%2Dsearch%2Dcancel%2Dbutton%2C%0Ainput%5Btype%3D%22search%22%5D%3A%3A%2Dwebkit%2Dsearch%2Ddecoration%20%7B%0A%20%20%20%20%2Dwebkit%2Dappearance%3A%20none%3B%0A%7D%0A%0A%2F%2A%2A%0A%20%2A%20Remove%20inner%20padding%20and%20border%20in%20Firefox%204%2B%2E%0A%20%2A%2F%0A%0Abutton%3A%3A%2Dmoz%2Dfocus%2Dinner%2C%0Ainput%3A%3A%2Dmoz%2Dfocus%2Dinner%20%7B%0A%20%20%20%20border%3A%200%3B%0A%20%20%20%20padding%3A%200%3B%0A%7D%0A%0A%2F%2A%2A%0A%20%2A%201%2E%20Remove%20default%20vertical%20scrollbar%20in%20IE%208%2F9%2E%0A%20%2A%202%2E%20Improve%20readability%20and%20alignment%20in%20all%20browsers%2E%0A%20%2A%2F%0A%0Atextarea%20%7B%0A%20%20%20%20overflow%3A%20auto%3B%20%2F%2A%201%20%2A%2F%0A%20%20%20%20vertical%2Dalign%3A%20top%3B%20%2F%2A%202%20%2A%2F%0A%7D%0A%0A%2F%2A%20%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%0A%20%20%20Tables%0A%20%20%20%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%20%2A%2F%0A%0A%2F%2A%2A%0A%20%2A%20Remove%20most%20spacing%20between%20table%20cells%2E%0A%20%2A%2F%0A%0Atable%20%7B%0A%20%20%20%20border%2Dcollapse%3A%20collapse%3B%0A%20%20%20%20border%2Dspacing%3A%200%3B%0A%7D%0A%0A%2Ego%2Dtop%20%7B%0Aposition%3A%20fixed%3B%0Abottom%3A%202em%3B%0Aright%3A%202em%3B%0Atext%2Ddecoration%3A%20none%3B%0Abackground%2Dcolor%3A%20%23E0E0E0%3B%0Afont%2Dsize%3A%2012px%3B%0Apadding%3A%201em%3B%0Adisplay%3A%20inline%3B%0A%7D%0A%0A%2F%2A%20Github%20css%20%2A%2F%0A%0Ahtml%2Cbody%7B%20%20%20%20%20%20%20%20margin%3A%20auto%3B%0A%20%20%20%20padding%2Dright%3A%201em%3B%0A%20%20%20%20padding%2Dleft%3A%201em%3B%0A%20%20%20%20max%2Dwidth%3A%2044em%3B%20color%3Ablack%3B%7D%2A%3Anot%28%27%23mkdbuttons%27%29%7Bmargin%3A0%3Bpadding%3A0%7Dbody%7Bfont%3A13%2E34px%20helvetica%2Carial%2Cfreesans%2Cclean%2Csans%2Dserif%3B%2Dwebkit%2Dfont%2Dsmoothing%3Asubpixel%2Dantialiased%3Bline%2Dheight%3A1%2E4%3Bpadding%3A3px%3Bbackground%3A%23fff%3Bborder%2Dradius%3A3px%3B%2Dmoz%2Dborder%2Dradius%3A3px%3B%2Dwebkit%2Dborder%2Dradius%3A3px%7Dp%7Bmargin%3A1em%200%7Da%7Bcolor%3A%234183c4%3Btext%2Ddecoration%3Anone%7Dbody%7Bbackground%2Dcolor%3A%23fff%3Bpadding%3A30px%3Bmargin%3A15px%3Bfont%2Dsize%3A14px%3Bline%2Dheight%3A1%2E6%7Dbody%3E%2A%3Afirst%2Dchild%7Bmargin%2Dtop%3A0%21important%7Dbody%3E%2A%3Alast%2Dchild%7Bmargin%2Dbottom%3A0%21important%7D%40media%20screen%7Bbody%7Bbox%2Dshadow%3A0%200%200%201px%20%23cacaca%2C0%200%200%204px%20%23eee%7D%7Dh1%2Ch2%2Ch3%2Ch4%2Ch5%2Ch6%7Bmargin%3A20px%200%2010px%3Bpadding%3A0%3Bfont%2Dweight%3Abold%3B%2Dwebkit%2Dfont%2Dsmoothing%3Asubpixel%2Dantialiased%3Bcursor%3Atext%7Dh1%7Bfont%2Dsize%3A28px%3Bcolor%3A%23000%7Dh2%7Bfont%2Dsize%3A24px%3Bborder%2Dbottom%3A1px%20solid%20%23ccc%3Bcolor%3A%23000%7Dh3%7Bfont%2Dsize%3A18px%3Bcolor%3A%23333%7Dh4%7Bfont%2Dsize%3A16px%3Bcolor%3A%23333%7Dh5%7Bfont%2Dsize%3A14px%3Bcolor%3A%23333%7Dh6%7Bcolor%3A%23777%3Bfont%2Dsize%3A14px%7Dp%2Cblockquote%2Ctable%2Cpre%7Bmargin%3A15px%200%7Dul%7Bpadding%2Dleft%3A30px%7Dol%7Bpadding%2Dleft%3A30px%7Dol%20li%20ul%3Afirst%2Dof%2Dtype%7Bmargin%2Dtop%3A0%7Dhr%7Bbackground%3Atransparent%20url%28data%3Aimage%2Fpng%3Bbase64%3Bbase64%2CiVBORw0KGgoAAAANSUhEUgAAAAYAAAAECAYAAACtBE5DAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw%2FeHBhY2tldCBiZWdpbj0i77u%2FIiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8%2BIDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNSBNYWNpbnRvc2giIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6OENDRjNBN0E2NTZBMTFFMEI3QjRBODM4NzJDMjlGNDgiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6OENDRjNBN0I2NTZBMTFFMEI3QjRBODM4NzJDMjlGNDgiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo4Q0NGM0E3ODY1NkExMUUwQjdCNEE4Mzg3MkMyOUY0OCIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo4Q0NGM0E3OTY1NkExMUUwQjdCNEE4Mzg3MkMyOUY0OCIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI%2FPqqezsUAAAAfSURBVHjaYmRABcYwBiM2QSA4y4hNEKYDQxAEAAIMAHNGAzhkPOlYAAAAAElFTkSuQmCC%29%20repeat%2Dx%200%200%3Bborder%3A0%20none%3Bcolor%3A%23ccc%3Bheight%3A4px%3Bpadding%3A0%7Dbody%3Eh2%3Afirst%2Dchild%7Bmargin%2Dtop%3A0%3Bpadding%2Dtop%3A0%7Dbody%3Eh1%3Afirst%2Dchild%7Bmargin%2Dtop%3A0%3Bpadding%2Dtop%3A0%7Dbody%3Eh1%3Afirst%2Dchild%2Bh2%7Bmargin%2Dtop%3A0%3Bpadding%2Dtop%3A0%7Dbody%3Eh3%3Afirst%2Dchild%2Cbody%3Eh4%3Afirst%2Dchild%2Cbody%3Eh5%3Afirst%2Dchild%2Cbody%3Eh6%3Afirst%2Dchild%7Bmargin%2Dtop%3A0%3Bpadding%2Dtop%3A0%7Da%3Afirst%2Dchild%20h1%2Ca%3Afirst%2Dchild%20h2%2Ca%3Afirst%2Dchild%20h3%2Ca%3Afirst%2Dchild%20h4%2Ca%3Afirst%2Dchild%20h5%2Ca%3Afirst%2Dchild%20h6%7Bmargin%2Dtop%3A0%3Bpadding%2Dtop%3A0%7Dh1%2Bp%2Ch2%2Bp%2Ch3%2Bp%2Ch4%2Bp%2Ch5%2Bp%2Ch6%2Bp%2Cul%20li%3E%3Afirst%2Dchild%2Col%20li%3E%3Afirst%2Dchild%7Bmargin%2Dtop%3A0%7Ddl%7Bpadding%3A0%7Ddl%20dt%7Bfont%2Dsize%3A14px%3Bfont%2Dweight%3Abold%3Bfont%2Dstyle%3Aitalic%3Bpadding%3A0%3Bmargin%3A15px%200%205px%7Ddl%20dt%3Afirst%2Dchild%7Bpadding%3A0%7Ddl%20dt%3E%3Afirst%2Dchild%7Bmargin%2Dtop%3A0%7Ddl%20dt%3E%3Alast%2Dchild%7Bmargin%2Dbottom%3A0%7Ddl%20dd%7Bmargin%3A0%200%2015px%3Bpadding%3A0%2015px%7Ddl%20dd%3E%3Afirst%2Dchild%7Bmargin%2Dtop%3A0%7Ddl%20dd%3E%3Alast%2Dchild%7Bmargin%2Dbottom%3A0%7Dblockquote%7Bborder%2Dleft%3A4px%20solid%20%23DDD%3Bpadding%3A0%2015px%3Bcolor%3A%23777%7Dblockquote%3E%3Afirst%2Dchild%7Bmargin%2Dtop%3A0%7Dblockquote%3E%3Alast%2Dchild%7Bmargin%2Dbottom%3A0%7Dtable%7Bborder%2Dcollapse%3Acollapse%3Bborder%2Dspacing%3A0%3Bfont%2Dsize%3A100%25%3Bfont%3Ainherit%7Dtable%20th%7Bfont%2Dweight%3Abold%3Bborder%3A1px%20solid%20%23ccc%3Bpadding%3A6px%2013px%7Dtable%20td%7Bborder%3A1px%20solid%20%23ccc%3Bpadding%3A6px%2013px%7Dtable%20tr%7Bborder%2Dtop%3A1px%20solid%20%23ccc%3Bbackground%2Dcolor%3A%23fff%7Dtable%20tr%3Anth%2Dchild%282n%29%7Bbackground%2Dcolor%3A%23f8f8f8%7Dimg%7Bmax%2Dwidth%3A100%25%7Dcode%2Ctt%7Bmargin%3A0%202px%3Bpadding%3A0%205px%3Bwhite%2Dspace%3Anowrap%3Bborder%3A1px%20solid%20%23eaeaea%3Bbackground%2Dcolor%3A%23f8f8f8%3Bborder%2Dradius%3A3px%3Bfont%2Dfamily%3AConsolas%2C%27Liberation%20Mono%27%2CCourier%2Cmonospace%3Bfont%2Dsize%3A12px%3Bcolor%3A%23333%7Dpre%3Ecode%7Bmargin%3A0%3Bpadding%3A0%3Bwhite%2Dspace%3Apre%3Bborder%3A0%3Bbackground%3Atransparent%7D%2Ehighlight%20pre%7Bbackground%2Dcolor%3A%23f8f8f8%3Bborder%3A1px%20solid%20%23ccc%3Bfont%2Dsize%3A13px%3Bline%2Dheight%3A19px%3Boverflow%3Aauto%3Bpadding%3A6px%2010px%3Bborder%2Dradius%3A3px%7Dpre%7Bbackground%2Dcolor%3A%23f8f8f8%3Bborder%3A1px%20solid%20%23ccc%3Bfont%2Dsize%3A13px%3Bline%2Dheight%3A19px%3Boverflow%3Aauto%3Bpadding%3A6px%2010px%3Bborder%2Dradius%3A3px%7Dpre%20code%2Cpre%20tt%7Bbackground%2Dcolor%3Atransparent%3Bborder%3A0%7D%2Epoetry%20pre%7Bfont%2Dfamily%3AGeorgia%2CGaramond%2Cserif%21important%3Bfont%2Dstyle%3Aitalic%3Bfont%2Dsize%3A110%25%21important%3Bline%2Dheight%3A1%2E6em%3Bdisplay%3Ablock%3Bmargin%2Dleft%3A1em%7D%2Epoetry%20pre%20code%7Bfont%2Dfamily%3AGeorgia%2CGaramond%2Cserif%21important%3Bword%2Dbreak%3Abreak%2Dall%3Bword%2Dbreak%3Abreak%2Dword%3B%2Dwebkit%2Dhyphens%3Aauto%3B%2Dmoz%2Dhyphens%3Aauto%3Bhyphens%3Aauto%3Bwhite%2Dspace%3Apre%2Dwrap%7Dsup%2Csub%2Ca%2Efootnote%7Bfont%2Dsize%3A1%2E4ex%3Bheight%3A0%3Bline%2Dheight%3A1%3Bvertical%2Dalign%3Asuper%3Bposition%3Arelative%7Dsub%7Bvertical%2Dalign%3Asub%3Btop%3A%2D1px%7D%40media%20print%7Bbody%7Bbackground%3A%23fff%7Dimg%2Cpre%2Cblockquote%2Ctable%2Cfigure%7Bpage%2Dbreak%2Dinside%3Aavoid%7Dbody%7Bbackground%3A%23fff%3Bborder%3A0%7Dcode%7Bbackground%2Dcolor%3A%23fff%3Bcolor%3A%23333%21important%3Bpadding%3A0%20%2E2em%3Bborder%3A1px%20solid%20%23dedede%7Dpre%7Bbackground%3A%23fff%7Dpre%20code%7Bbackground%2Dcolor%3Awhite%21important%3Boverflow%3Avisible%7D%7D%40media%20screen%7Bbody%2Einverted%7Bcolor%3A%23eee%21important%3Bborder%2Dcolor%3A%23555%3Bbox%2Dshadow%3Anone%7D%2Einverted%20body%2C%2Einverted%20hr%20%2Einverted%20p%2C%2Einverted%20td%2C%2Einverted%20li%2C%2Einverted%20h1%2C%2Einverted%20h2%2C%2Einverted%20h3%2C%2Einverted%20h4%2C%2Einverted%20h5%2C%2Einverted%20h6%2C%2Einverted%20th%2C%2Einverted%20%2Emath%2C%2Einverted%20caption%2C%2Einverted%20dd%2C%2Einverted%20dt%2C%2Einverted%20blockquote%7Bcolor%3A%23eee%21important%3Bborder%2Dcolor%3A%23555%3Bbox%2Dshadow%3Anone%7D%2Einverted%20td%2C%2Einverted%20th%7Bbackground%3A%23333%7D%2Einverted%20h2%7Bborder%2Dcolor%3A%23555%7D%2Einverted%20hr%7Bborder%2Dcolor%3A%23777%3Bborder%2Dwidth%3A1px%21important%7D%3A%3Aselection%7Bbackground%3Argba%28157%2C193%2C200%2C0%2E5%29%7Dh1%3A%3Aselection%7Bbackground%2Dcolor%3Argba%2845%2C156%2C208%2C0%2E3%29%7Dh2%3A%3Aselection%7Bbackground%2Dcolor%3Argba%2890%2C182%2C224%2C0%2E3%29%7Dh3%3A%3Aselection%2Ch4%3A%3Aselection%2Ch5%3A%3Aselection%2Ch6%3A%3Aselection%2Cli%3A%3Aselection%2Col%3A%3Aselection%7Bbackground%2Dcolor%3Argba%28133%2C201%2C232%2C0%2E3%29%7Dcode%3A%3Aselection%7Bbackground%2Dcolor%3Argba%280%2C0%2C0%2C0%2E7%29%3Bcolor%3A%23eee%7Dcode%20span%3A%3Aselection%7Bbackground%2Dcolor%3Argba%280%2C0%2C0%2C0%2E7%29%21important%3Bcolor%3A%23eee%21important%7Da%3A%3Aselection%7Bbackground%2Dcolor%3Argba%28255%2C230%2C102%2C0%2E2%29%7D%2Einverted%20a%3A%3Aselection%7Bbackground%2Dcolor%3Argba%28255%2C230%2C102%2C0%2E6%29%7Dtd%3A%3Aselection%2Cth%3A%3Aselection%2Ccaption%3A%3Aselection%7Bbackground%2Dcolor%3Argba%28180%2C237%2C95%2C0%2E5%29%7D%2Einverted%7Bbackground%3A%230b2531%3Bbackground%3A%23252a2a%7D%2Einverted%20body%7Bbackground%3A%23252a2a%7D%2Einverted%20a%7Bcolor%3A%23acd1d5%7D%7D%2Ehighlight%20%2Ec%7Bcolor%3A%23998%3Bfont%2Dstyle%3Aitalic%7D%2Ehighlight%20%2Eerr%7Bcolor%3A%23a61717%3Bbackground%2Dcolor%3A%23e3d2d2%7D%2Ehighlight%20%2Ek%2C%2Ehighlight%20%2Eo%7Bfont%2Dweight%3Abold%7D%2Ehighlight%20%2Ecm%7Bcolor%3A%23998%3Bfont%2Dstyle%3Aitalic%7D%2Ehighlight%20%2Ecp%7Bcolor%3A%23999%3Bfont%2Dweight%3Abold%7D%2Ehighlight%20%2Ec1%7Bcolor%3A%23998%3Bfont%2Dstyle%3Aitalic%7D%2Ehighlight%20%2Ecs%7Bcolor%3A%23999%3Bfont%2Dweight%3Abold%3Bfont%2Dstyle%3Aitalic%7D%2Ehighlight%20%2Egd%7Bcolor%3A%23000%3Bbackground%2Dcolor%3A%23fdd%7D%2Ehighlight%20%2Egd%20%2Ex%7Bcolor%3A%23000%3Bbackground%2Dcolor%3A%23faa%7D%2Ehighlight%20%2Ege%7Bfont%2Dstyle%3Aitalic%7D%2Ehighlight%20%2Egr%7Bcolor%3A%23a00%7D%2Ehighlight%20%2Egh%7Bcolor%3A%23999%7D%2Ehighlight%20%2Egi%7Bcolor%3A%23000%3Bbackground%2Dcolor%3A%23dfd%7D%2Ehighlight%20%2Egi%20%2Ex%7Bcolor%3A%23000%3Bbackground%2Dcolor%3A%23afa%7D%2Ehighlight%20%2Ego%7Bcolor%3A%23888%7D%2Ehighlight%20%2Egp%7Bcolor%3A%23555%7D%2Ehighlight%20%2Egs%7Bfont%2Dweight%3Abold%7D%2Ehighlight%20%2Egu%7Bcolor%3A%23800080%3Bfont%2Dweight%3Abold%7D%2Ehighlight%20%2Egt%7Bcolor%3A%23a00%7D%2Ehighlight%20%2Ekc%2C%2Ehighlight%20%2Ekd%2C%2Ehighlight%20%2Ekn%2C%2Ehighlight%20%2Ekp%2C%2Ehighlight%20%2Ekr%7Bfont%2Dweight%3Abold%7D%2Ehighlight%20%2Ekt%7Bcolor%3A%23458%3Bfont%2Dweight%3Abold%7D%2Ehighlight%20%2Em%7Bcolor%3A%23099%7D%2Ehighlight%20%2Es%7Bcolor%3A%23d14%7D%2Ehighlight%20%2Ena%7Bcolor%3A%23008080%7D%2Ehighlight%20%2Enb%7Bcolor%3A%230086b3%7D%2Ehighlight%20%2Enc%7Bcolor%3A%23458%3Bfont%2Dweight%3Abold%7D%2Ehighlight%20%2Eno%7Bcolor%3A%23008080%7D%2Ehighlight%20%2Eni%7Bcolor%3A%23800080%7D%2Ehighlight%20%2Ene%2C%2Ehighlight%20%2Enf%7Bcolor%3A%23900%3Bfont%2Dweight%3Abold%7D%2Ehighlight%20%2Enn%7Bcolor%3A%23555%7D%2Ehighlight%20%2Ent%7Bcolor%3A%23000080%7D%2Ehighlight%20%2Env%7Bcolor%3A%23008080%7D%2Ehighlight%20%2Eow%7Bfont%2Dweight%3Abold%7D%2Ehighlight%20%2Ew%7Bcolor%3A%23bbb%7D%2Ehighlight%20%2Emf%2C%2Ehighlight%20%2Emh%2C%2Ehighlight%20%2Emi%2C%2Ehighlight%20%2Emo%7Bcolor%3A%23099%7D%2Ehighlight%20%2Esb%2C%2Ehighlight%20%2Esc%2C%2Ehighlight%20%2Esd%2C%2Ehighlight%20%2Es2%2C%2Ehighlight%20%2Ese%2C%2Ehighlight%20%2Esh%2C%2Ehighlight%20%2Esi%2C%2Ehighlight%20%2Esx%7Bcolor%3A%23d14%7D%2Ehighlight%20%2Esr%7Bcolor%3A%23009926%7D%2Ehighlight%20%2Es1%7Bcolor%3A%23d14%7D%2Ehighlight%20%2Ess%7Bcolor%3A%23990073%7D%2Ehighlight%20%2Ebp%7Bcolor%3A%23999%7D%2Ehighlight%20%2Evc%2C%2Ehighlight%20%2Evg%2C%2Ehighlight%20%2Evi%7Bcolor%3A%23008080%7D%2Ehighlight%20%2Eil%7Bcolor%3A%23099%7D%2Ehighlight%20%2Egc%7Bcolor%3A%23999%3Bbackground%2Dcolor%3A%23eaf2f5%7D%2Etype%2Dcsharp%20%2Ehighlight%20%2Ek%2C%2Etype%2Dcsharp%20%2Ehighlight%20%2Ekt%7Bcolor%3A%2300F%7D%2Etype%2Dcsharp%20%2Ehighlight%20%2Enf%7Bcolor%3A%23000%3Bfont%2Dweight%3Anormal%7D%2Etype%2Dcsharp%20%2Ehighlight%20%2Enc%7Bcolor%3A%232b91af%7D%2Etype%2Dcsharp%20%2Ehighlight%20%2Enn%7Bcolor%3A%23000%7D%2Etype%2Dcsharp%20%2Ehighlight%20%2Es%2C%2Etype%2Dcsharp%20%2Ehighlight%20%2Esc%7Bcolor%3A%23a31515%7D%0A" rel="stylesheet" type="text/css" />
</head>
<body>
<p>Leukerbad Spring School Bioinformatics and Population Genomics</p>
<hr />
<h1 id="practical-rna-seq-analysis-for-population-genomics">Practical: RNA-seq analysis for population genomics</h1>
<p>Julien Roux, version 1, May 2016</p>
<h2 id="schedule">Schedule</h2>
<ul class="incremental">
<li>[ ] Wednesday 1 June, 16:45 to 17:45: from raw sequencing data to transcript expression levels. Practical 3.1.<br /></li>
<li>[x] <strong>Thursday 2 June, 13:45 to 15:30: gene-level clustering and differential expression analysis. Practical 4.1+4.2</strong></li>
</ul>
<h2 id="introduction">Introduction</h2>
<p>Today you will pursue the analysis of Bou Sleiman et al. <em>Drosophila melanogaster</em> data. Unless you managed to map all samples yesterday (:clap:), use the pre-processed <code>Kallisto</code> results located in the <code>~/data/rnaseq/kallisto/SRR*</code> folders. The analysis will be going through the following steps:</p>
<ul class="incremental">
<li>Organize the metadata, so that we know precisely the experimental conditions of each sample<br /></li>
<li>Import <code>Kallisto</code> results and sum the transcript-level abundances to gene-level abundances. This allows to obtain expression levels that are not affected by differential transcript usage or differential splicing.<br /></li>
<li>Normalize the data across samples<br /></li>
<li>Perform some clustering analyses. This is a good first approach of the data, and allows to detect potential problems with the data.<br /></li>
<li>Study differential expression between strains and experimental conditions.<br /></li>
<li>If time permits, perform some gene ontology and anatomical ontology enrichment analyses<br /></li>
<li>If time permits, connect the patterns of differential expression to patterns of sequence evolution</li>
</ul>
<p>In the interest of time, most of the R commands are given fully, and can simply copy-paste them. I encourage you to read the commands fully and try to understand what was done. Try and modify some parameters, or ask the assistants if something is not clear.</p>
<h2 id="read-and-format-the-metadata">Read and format the metadata</h2>
<p>Don't forget to create today's working directory:</p>
<pre class="sh"><code>mkdir -p ~/2016-06-02-rnaseq/results/</code></pre>
<p>Launch R in the console or use Rstudio. Then:</p>
<pre class="sourceCode R"><code class="sourceCode r">## path to the data
dataFolder &lt;-<span class="st"> &quot;~/data/rnaseq/&quot;</span>
## Set up the working directory
<span class="kw">setwd</span>(<span class="st">&quot;~/2016-06-02-rnaseq/results/&quot;</span>)</code></pre>
<p>You will first read and format the experiment metadata using the GEOquery package (<a href="http://www.bioconductor.org/packages/release/bioc/vignettes/GEOquery/inst/doc/GEOquery.html">http://www.bioconductor.org/packages/release/bioc/vignettes/GEOquery/inst/doc/GEOquery.html</a>). The metadata are located in the <code>GSE59411_series_matrix.txt</code> file that was pre-downloaded on the GEO page of the experiment. Metadata can also be read from the <code>GSE59411_family.soft</code> file, or by passing the experiment name to the GEOquery package (beware, the format of the resulting R object will slightly differ depending on the approach used). The following steps are a bit boring, but try to understand what was done:</p>
<pre class="sourceCode R"><code class="sourceCode r">## Should not be needed:
## source(&quot;http://bioconductor.org/biocLite.R&quot;)
## biocLite(&quot;GEOquery&quot;)
<span class="kw">library</span>(GEOquery)
## Read the metadata file
gse &lt;-<span class="st"> </span><span class="kw">getGEO</span>(<span class="dt">filename=</span><span class="kw">file.path</span>(dataFolder, <span class="st">&quot;GSE59411_series_matrix.txt&quot;</span>))
## Extract the metadata, and only retain some of the columns
samples &lt;-<span class="st"> </span><span class="kw">pData</span>(<span class="kw">phenoData</span>(gse))[,<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>, <span class="dv">8</span>:<span class="dv">12</span>, <span class="dv">45</span>)]
## Extract the SRA ID of samples by parsing the FTP URL
samples$library_accession &lt;-<span class="st"> </span><span class="kw">unlist</span>(
  <span class="kw">lapply</span>(<span class="kw">strsplit</span>(<span class="kw">as.character</span>(samples$supplementary_file_2), <span class="dt">split=</span><span class="st">&quot;/&quot;</span>), tail, <span class="dt">n=</span><span class="dv">1</span>))
## Read the ENA metadata, which includes the run ID (SRR...)
samplesENA &lt;-<span class="st"> </span><span class="kw">read.table</span>(<span class="kw">file.path</span>(dataFolder, <span class="st">&quot;SRP044339.txt&quot;</span>), <span class="dt">h=</span>T, <span class="dt">sep=</span><span class="st">&quot;</span><span class="ch">\t</span><span class="st">&quot;</span>)
## Merge both data frames
samples &lt;-<span class="st"> </span><span class="kw">merge</span>(samples, samplesENA, <span class="dt">by.x=</span><span class="st">&quot;library_accession&quot;</span>, <span class="dt">by.y=</span><span class="st">&quot;experiment_accession&quot;</span>)
## Filter and rearrange the columns
samples &lt;-<span class="st"> </span>samples[,<span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">4</span>:<span class="dv">8</span>, <span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">14</span>)]
## Rename the columns
<span class="kw">names</span>(samples)[<span class="dv">4</span>] &lt;-<span class="st"> &quot;treatment&quot;</span>
<span class="kw">names</span>(samples)[<span class="dv">5</span>] &lt;-<span class="st"> &quot;dgrp_line&quot;</span>
<span class="kw">names</span>(samples)[<span class="dv">6</span>] &lt;-<span class="st"> &quot;resistance&quot;</span>
## Simplify the levels of experimental factors
samples$treatment &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&quot;treatment: &quot;</span>, <span class="st">&quot;&quot;</span>, samples$treatment)
samples$dgrp_line &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&quot;dgrp line: &quot;</span>, <span class="st">&quot;&quot;</span>, samples$dgrp_line)
samples$resistance &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&quot;resistance: &quot;</span>, <span class="st">&quot;&quot;</span>, samples$resistance)
## Visualize the formatted metadata table
<span class="kw">head</span>(samples)
<span class="kw">dim</span>(samples)</code></pre>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAAA3NCSVQICAjb4U/gAAAACXBIWXMAAAEbAAABGwGN907lAAAAGXRFWHRTb2Z0d2FyZQB3d3cuaW5rc2NhcGUub3Jnm+48GgAAALRQTFRF////AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAokSIKwAAADt0Uk5TAAEDBgcICQsMDhATFRcbHSEkJS0uNj5BQkVJU1hfYnN9lZaXmJynwcTGzM/a3+Dh4uXm6O3x8vP1+PpY7DV9AAABVUlEQVQ4y4VTW1uCQBA9KpZiZniBQiwCFLANIZG1zv//Xz3I6qL1MU97Zuc+Z4CzGG4UCylFHLkGbmUcVDxLFYyvvnu+JIvQsy3L9sKClH6v4Z6QqdNRsOOkZKIFmeUsl82Qy5L57OyfU0yva5oK5nWMXkIxuq16JJic6vBZKv/haxC8DlWMkj4AjCVVfntHkjtb1UE5BhAwrRWTA4/r9ZGHSa1IGQBGRafGG25NwNxyUyscVgZcFqr/PVcAsOJezaOgi4hhDfvfZR8AHsn7WhUyQkxPNfa8AAC88UtpPMYQtJv9Lz75rt42BSQt/dvbkvsHhSzKK4O7H/LjCbpBM4VJvmjQptCLPBmYekLGWpt/GISM9EEB6GZZ94I6BV191AAwGGjAYWXoywJgZpmWImXQXDcwJ+cX2p3WrRMGWF6MFWHaKddK2nbatx9O++m1H+//5/8LzCw8IyeUP9gAAAAASUVORK5CYII=" alt="Question" /><br />According to the metadata table, how many experimental factors of interest do you identify in this experiment? Draw a simple diagram to represent the experimental design.</p>
<p>For simplicity, we will ignore the strain effect (<code>dgrp_line</code>), and consider the four susceptible and the four resistant lines as simple biological replicates.</p>
<h2 id="import-the-transcripts-expression-levels-and-sum-them-at-the-gene-level">Import the transcripts expression levels and sum them at the gene level</h2>
<p>You will use the Mike Love's <code>tximport</code> package to directly parse <code>Kallisto</code> results files and sum expression at the gene-level (<a href="https://github.com/mikelove/tximport">https://github.com/mikelove/tximport</a>). As <code>tximport</code> was not yet available on R/Bioconductor 3.2 installed on the virtual machine (it is now available in release 3.3), you will install it from the source code, that is already in the data folder:</p>
<pre class="sourceCode R"><code class="sourceCode r"><span class="kw">install.packages</span>(<span class="kw">file.path</span>(dataFolder, <span class="st">&quot;./tximport-master&quot;</span>), <span class="dt">repos =</span> <span class="ot">NULL</span>, <span class="dt">type=</span><span class="st">&quot;source&quot;</span>)
<span class="kw">library</span>(tximport)

## Path to Kallisto result files
files &lt;-<span class="st"> </span><span class="kw">file.path</span>(dataFolder, <span class="st">&quot;kallisto&quot;</span>, samples$run_accession, <span class="st">&quot;abundance.tsv&quot;</span>)
<span class="kw">names</span>(files) &lt;-<span class="st"> </span>samples$title
## Check that all files are present in the data folder
<span class="kw">all</span>(<span class="kw">file.exists</span>(files))</code></pre>
<p>To sum up transcript expression levels, <code>tximport</code> needs a data.frame with a transcript ID column and a gene ID column. You will retrieve this information from the Ensembl database via the Biomart webservice. Biomart queries require the specification of:</p>
<p>1) a dataset to use</p>
<p>2) a list of filters to select specific Ensembl genes (not needed in our case)</p>
<p>3) a list of attributes to output.</p>
<p>It is possible to build the Biomart query from the web interface (<a href="http://www.ensembl.org/biomart/martview/368fdd3310212bc95ef4d904847c1408?VIRTUALSCHEMANAME=default&amp;ATTRIBUTES=dmelanogaster_gene_ensembl.default.feature_page.ensembl_transcript_id|dmelanogaster_gene_ensembl.default.feature_page.ensembl_gene_id&amp;FILTERS=&amp;VISIBLEPANEL=resultspanel">the needed query would be obtain by specifying the following dataset and attributes</a>), but there is a Bioconductor package called <code>biomaRt</code> that allows to obtain results directly into R<a href="./transcript2gene.txt">:</a></p>
<pre class="sourceCode R"><code class="sourceCode r"><span class="kw">library</span>(biomaRt)
## Choose D. melanogaster dataset in Ensembl release 84
mart &lt;-<span class="st"> </span><span class="kw">useMart</span>(<span class="st">&quot;ENSEMBL_MART_ENSEMBL&quot;</span>, <span class="dt">dataset =</span> <span class="st">&quot;dmelanogaster_gene_ensembl&quot;</span>, <span class="dt">host=</span><span class="st">&quot;mar2016.archive.ensembl.org&quot;</span>)
## retrieve the mapping between transcript and gene IDs
transcript2gene &lt;-<span class="st"> </span><span class="kw">getBM</span>(<span class="dt">attributes=</span><span class="kw">c</span>(<span class="st">&quot;ensembl_transcript_id&quot;</span>, <span class="st">&quot;ensembl_gene_id&quot;</span>), <span class="dt">mart=</span>mart) 
## Sort by gene ID
transcript2gene &lt;-<span class="st"> </span>transcript2gene[<span class="kw">order</span>(transcript2gene$ensembl_gene_id), ]
<span class="kw">head</span>(transcript2gene)</code></pre>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAAuQAAALkB4qdB6AAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAMxSURBVFiFvZfNS5RRFMZ/Z2YIPxPCKBEyUAQ3gvQlrQInWrQQgoSWLXQVWCH9Ca1atPBPqAgSXEsSIglRCi4Cg0RmM5pYUYr4UXhavOdlrnfu+zpvWAcOM/Occ57zzJn73ntHVBURmQYOgNuq+pN/aCLSArwCcqpaLBh+AFwHpkTkRpoIETkJXAQuAZcNfg98AOZVdfOI5lPAFeA1AKoK0AK8A9ReG1QV14Eu4I2J1QQ/sJyuQH2D16NFVXETXBFFB88B94Fti60Az4BR4Kr5qGErlrNtWM7hKfrNDwlwVBaBvH1uBGatcBd4FMdCDuQtZ9dqZoFGJ1b0pxskcgjHjWge6EnL9ep6rEaB8dTcFJIB+03XgdZamzv1rVZ7AAxkEgA0AyX7BreyNnd4bhlHCWjOImDECl/+bXOH66VxjYTiOcJ2wV6fJ8SzWMxxIRQ8SsDCMQiIOYICxMZUAUROAFvAd1VtOwYBiMgacIpoHey7sdAEOoATwPJxNDdbNs4OP1CozqXsCKkyETkDJE1mTVXXA3jMVa6KJKzcVaKV2+Th56hsySHfBs55NU0WWw31Ck0A4KN9y35g2sE3qUxtAdiw96eJFlnBclzrdzir7YgNZC4Qm7DYAwd7YNhEIH+OlA0tSUAO+GyFg17spuGTDjZp2E0vd9Dwzzgn45ECrHjIijeAXgfPEz2m3wAx/2ZY3snrtVoFhjKdBQ7JYyP4CvQ5eHzunzJXYMWJ91mNAo9Te3gN24F7QL19FuCFEe0AT4kW54JhZ83VsDbL2THsBZXNrt6424MCgPNUTsCiJ2zYRhwL+WHv75qrYXHjLWDY44hvRCXg/CEBXvNXBG49QDfJz7/v3YH6vHEfEhEHF53mhYT1UGc5ZeAa0ZH9xHzEsLLl1CVwFBwRi+5G9Jbo/vZQVX+Tbr9UdQaY8QMi8iutUFV/i8gdYI34HEpboQkTKKXklNImEPKk+8B/s6SzIM3aReRTUiwrWdWFJDFRpI7oMavF6lV1t5bELD/BHtHFYg/oJNpYXO/0cmqzWheLTWqMaJHtA18837fYWCbOjAIaiP4nLlG9+SxZrOqPbZr/Acin3r66y1JbAAAAAElFTkSuQmCC" alt="Tip" /><br />Tip: specifying the <code>host</code> argument in the <code>biomaRt</code> query allows to choose which Ensembl release you wish to work with (in this case, <code>mar2016.archive.ensembl.org</code> redirects to release 84). This is very helpful to make your code reproducible.</p>
<!--
If biomaRt doesn't work, the file was pre-downloaded and you can import it using:
transcript2gene <- read.table("GenomicsCourse/2016-SIB/practicals/rnaseq/transcript2gene.txt", h=T, sep="\t")
-->


<p>You will now import <code>Kallisto</code> results:</p>
<pre class="sourceCode R"><code class="sourceCode r">txi &lt;-<span class="st"> </span><span class="kw">tximport</span>(files, <span class="dt">type =</span> <span class="st">&quot;kallisto&quot;</span>, <span class="dt">tx2gene =</span> transcript2gene, <span class="dt">countsFromAbundance=</span><span class="st">&quot;scaledTPM&quot;</span>)
## Visualize the created txi object:
<span class="kw">lapply</span>(txi, head)</code></pre>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAAA3NCSVQICAjb4U/gAAAACXBIWXMAAAEbAAABGwGN907lAAAAGXRFWHRTb2Z0d2FyZQB3d3cuaW5rc2NhcGUub3Jnm+48GgAAALRQTFRF////AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAokSIKwAAADt0Uk5TAAEDBgcICQsMDhATFRcbHSEkJS0uNj5BQkVJU1hfYnN9lZaXmJynwcTGzM/a3+Dh4uXm6O3x8vP1+PpY7DV9AAABVUlEQVQ4y4VTW1uCQBA9KpZiZniBQiwCFLANIZG1zv//Xz3I6qL1MU97Zuc+Z4CzGG4UCylFHLkGbmUcVDxLFYyvvnu+JIvQsy3L9sKClH6v4Z6QqdNRsOOkZKIFmeUsl82Qy5L57OyfU0yva5oK5nWMXkIxuq16JJic6vBZKv/haxC8DlWMkj4AjCVVfntHkjtb1UE5BhAwrRWTA4/r9ZGHSa1IGQBGRafGG25NwNxyUyscVgZcFqr/PVcAsOJezaOgi4hhDfvfZR8AHsn7WhUyQkxPNfa8AAC88UtpPMYQtJv9Lz75rt42BSQt/dvbkvsHhSzKK4O7H/LjCbpBM4VJvmjQptCLPBmYekLGWpt/GISM9EEB6GZZ94I6BV191AAwGGjAYWXoywJgZpmWImXQXDcwJ+cX2p3WrRMGWF6MFWHaKddK2nbatx9O++m1H+//5/8LzCw8IyeUP9gAAAAASUVORK5CYII=" alt="Question" /><br />What are abundances? What are &quot;counts&quot; in this particular case? Why are length estimates not integers (remember note about <code>Kallisto</code> --bias option yesterday)?</p>
<p>I suggest to have a look at this interesting paper:</p>
<p>Soneson C, Love M and Robinson M. Differential analyses for RNA-seq: transcript-level estimates improve gene-level inferences. <em>F1000Research</em>. 2015;4(1521) (<a href="http://f1000research.com/articles/4-1521/v2">http://f1000research.com/articles/4-1521/v2</a>). A PDF of the paper is located in the <code>~/data/papers/</code> folder.</p>
<p>In this paper, Soneson and colleagues show that gene-level abundance estimates offer advantages over transcript-level analyses. They are more accurate, more stable, more interpretable, and allow better control on false positives in the presence of differential isoform usage. For this purpose, they introduced the &quot;scaledTPM&quot; values, which are obtained by summing the transcript-level TPMs by gene, and multiplying them with the total library size in millions. ScaledTPM values are artificial values, transforming underlying abundance measures to the scale of read counts. This allows to incorporate the information provided by the sequencing depth, and work with RNA-seq differential expression tools that were developed to use read counts, while controlling for the length of transcripts expressed for each gene in each given condition.</p>
<h2 id="data-normalization">Data normalization</h2>
<p>You will import the gene expression data into a <code>edgeR</code> DGE object and obtain normalization factors for each sample. The default normalization method in <code>edgeR</code> is called TMM. It was previously shown to perform quite well, while not too stringent.</p>
<pre class="sourceCode R"><code class="sourceCode r"><span class="kw">library</span>(edgeR)
<span class="kw">library</span>(limma)
y &lt;-<span class="st"> </span><span class="kw">DGEList</span>(txi$counts)
y &lt;-<span class="st"> </span><span class="kw">calcNormFactors</span>(y)
y$samples</code></pre>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAAA3NCSVQICAjb4U/gAAAACXBIWXMAAAEbAAABGwGN907lAAAAGXRFWHRTb2Z0d2FyZQB3d3cuaW5rc2NhcGUub3Jnm+48GgAAALRQTFRF////AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAokSIKwAAADt0Uk5TAAEDBgcICQsMDhATFRcbHSEkJS0uNj5BQkVJU1hfYnN9lZaXmJynwcTGzM/a3+Dh4uXm6O3x8vP1+PpY7DV9AAABVUlEQVQ4y4VTW1uCQBA9KpZiZniBQiwCFLANIZG1zv//Xz3I6qL1MU97Zuc+Z4CzGG4UCylFHLkGbmUcVDxLFYyvvnu+JIvQsy3L9sKClH6v4Z6QqdNRsOOkZKIFmeUsl82Qy5L57OyfU0yva5oK5nWMXkIxuq16JJic6vBZKv/haxC8DlWMkj4AjCVVfntHkjtb1UE5BhAwrRWTA4/r9ZGHSa1IGQBGRafGG25NwNxyUyscVgZcFqr/PVcAsOJezaOgi4hhDfvfZR8AHsn7WhUyQkxPNfa8AAC88UtpPMYQtJv9Lz75rt42BSQt/dvbkvsHhSzKK4O7H/LjCbpBM4VJvmjQptCLPBmYekLGWpt/GISM9EEB6GZZ94I6BV191AAwGGjAYWXoywJgZpmWImXQXDcwJ+cX2p3WrRMGWF6MFWHaKddK2nbatx9O++m1H+//5/8LzCw8IyeUP9gAAAAASUVORK5CYII=" alt="Question" /><br />What is the meaning of each column in this data frame?</p>
<p>You will now look at the data distribution in the DGE object. The <code>cpm</code> function returns counts per million reads. Because you used scaledTPMs instead of real counts, this is equivalent to the initial TPMs used to create the scaledTPMs. But these are additionally normalized by dividing each samples values by the TMM normalization factor:</p>
<pre class="sourceCode R"><code class="sourceCode r">## Load a nice color palette of 9 + 8 colors to be used for plots
<span class="kw">library</span>(RColorBrewer)
myPalette &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">brewer.pal</span>(<span class="dv">9</span>, <span class="st">&quot;Set1&quot;</span>), <span class="kw">brewer.pal</span>(<span class="dv">8</span>, <span class="st">&quot;Set2&quot;</span>))
## Plot CPM distribution
<span class="kw">plotDensities</span>(<span class="kw">cpm</span>(y), <span class="dt">col=</span>myPalette[<span class="dv">1</span>:<span class="dv">16</span>], <span class="dt">legend=</span><span class="st">&quot;topright&quot;</span>)
## Try with logged CPM
unfilteredExpr &lt;-<span class="st"> </span><span class="kw">cpm</span>(y, <span class="dt">log=</span>T)
?cpm ## note that a small value is added to the counts if log=T
<span class="kw">plotDensities</span>(unfilteredExpr, <span class="dt">col=</span>myPalette[<span class="dv">1</span>:<span class="dv">16</span>], <span class="dt">legend=</span><span class="st">&quot;topright&quot;</span>)</code></pre>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAAA3NCSVQICAjb4U/gAAAACXBIWXMAAAEbAAABGwGN907lAAAAGXRFWHRTb2Z0d2FyZQB3d3cuaW5rc2NhcGUub3Jnm+48GgAAALRQTFRF////AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAokSIKwAAADt0Uk5TAAEDBgcICQsMDhATFRcbHSEkJS0uNj5BQkVJU1hfYnN9lZaXmJynwcTGzM/a3+Dh4uXm6O3x8vP1+PpY7DV9AAABVUlEQVQ4y4VTW1uCQBA9KpZiZniBQiwCFLANIZG1zv//Xz3I6qL1MU97Zuc+Z4CzGG4UCylFHLkGbmUcVDxLFYyvvnu+JIvQsy3L9sKClH6v4Z6QqdNRsOOkZKIFmeUsl82Qy5L57OyfU0yva5oK5nWMXkIxuq16JJic6vBZKv/haxC8DlWMkj4AjCVVfntHkjtb1UE5BhAwrRWTA4/r9ZGHSa1IGQBGRafGG25NwNxyUyscVgZcFqr/PVcAsOJezaOgi4hhDfvfZR8AHsn7WhUyQkxPNfa8AAC88UtpPMYQtJv9Lz75rt42BSQt/dvbkvsHhSzKK4O7H/LjCbpBM4VJvmjQptCLPBmYekLGWpt/GISM9EEB6GZZ94I6BV191AAwGGjAYWXoywJgZpmWImXQXDcwJ+cX2p3WrRMGWF6MFWHaKddK2nbatx9O++m1H+//5/8LzCw8IyeUP9gAAAAASUVORK5CYII=" alt="Question" /><br />What do you observe? How are the data distributed? Why are there two modes? What would be a good cutoff to discriminate the two modes?</p>
<p>It is a good practice to filter out the genes that are not expressed, or very lowly expressed. This alleviates the multiple testing burden, and anyway there is very little power to detect differential expression for these genes. It is of course better to filter these genes after data normalization, before differential expression testing. The choice of a criterion to filter genes is arbitrary, but it has to make sense given the distribution of the data. You can for example put a cutoff on the summed expression of each gene across samples. Another apporach I tend to prefer, is to keep only the genes that pass a cutoff in at least n samples, where n is at least the number of biological replicates in each experimental condition. This ensures that almost all genes are seen expressed in at least one condition.</p>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAABgAAAAYABaOP7tAAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAHKSURBVFiFxZbBSgJRFIa/6yjtxBB9gEACEQl8gFZBgYgg7XoAF0JPEBS1DnetfIp20SsEiRBR+AKBRJsWppwW3YFJ7oz3Xkc98MPMnHv+8/9n7nhVIsI2I+tbqJRSQEPfPomvExHxAjAARGPgzePZvBNpHqKzEQHADjA2CBgDO658GY+3dg7sGZ7v6ZxbOLovA18G9yG+gPI6J3AN5BPyeb0m/QkAdWCW4D7EDKinvgmBx4VGH8ANcAd8L+QeUxUAtAxO25H8pSHfSkUAkAPeDA2CyJqGIf8G5NLYhD2gYtg788jtfDGva3pL2Ze4LwKfBneysO7AtEbXFleZwBVQWOoiPgqaIz4S3FeBnxhnthMQzVH1mcAtKxzXkchqLnPEuD9JcOQ6gRAnVp+hVvxiQViL1JxZrH8BsjYCehZkAjwANeDQUrAAvUQBwC4wsSTzwQTYTRLQX2PzEH2jAGAfmDoQvQKnGq8OdVNg3yTg3tFJ9DBqO9be//sdUEodAU3cYhpzbRNN3ROAABg5OhBgCBxpDD3qR7o3XY/itNDFU31aGGaAUvyrWnuUAv7+RB5vScCFEhGUUhX+DpRgQ43nwLOIvCv9HW8tfgFqVoEjNYWunQAAAABJRU5ErkJggg==" alt="Warning" /><br />Unless you know what you are doing, it is considered a bad practice to filter genes based on their variance prior to differential analysis! This can seriously bias your results.</p>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAA7AAAAOwBeShxvQAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAJGSURBVFiFxZc7aBVBFEDPjc+ACn6wEfJR/EBAKxE1xg/YiHY2Bq1UsBV7QbBUlDSS1FYiEtBC0UJfDGga0U4t/GvjB+QZFMTPtXizOF5mdmb3Bd/ALd7uvfec3dk3syuqSjdHT1fpnQiIiGTk9IjIThHZGE1S1dIAlgDDwFHgHHADeAl8A64CQ5G63cBrQF3cD+YFCnuB08AxoOk1iMUboGF6jAK/TN7tpICDX8uA+nHT9NgBfLdwYGGOwHhFeNM2Bi6ZnHsxeEjgQgX4FLDI1AvwyeQdCUyzAMeBPv/gWuBtJnzawl2PZYHch8BSAy/u9EQd+Ge/oREYjNQ8cHI+XIH3VeFFXME8+U5gU0nNR+CJOTYJ8LgiPCgBrAgAUrEH4GJNgUJiXk342WIfarhGsUS7oPgxVhN+6p+/YYnEXWAD8Kom/CswA9wCLgMngHXBdSAg0cT91YBVRiIHPgtsT+415iluABO0VzO7whUSufCRFDy4GSV2xuUZ8C+5cFWt/D4w303NUOT8LLAXQEQaWR0rXH3OlW8DDgA/iCxWtaagAnwU+OkdT0rMFXwYOGjgWRKdwlsOvj8CT0p0DHe5/cCzktyoRAzeS/km1QK2mpoB4HlC4mSuwCFXcAbYB3wogxuJFyUC7+xdiAlMuoI+87sFbEk8N4MJidU5Aof5uxmdp/2Wm4R79StpfztY+HTuFCwA7niFj4DNOXAjcR347Xo8BXbZPHHJwSEi64HFqjoTTUoMEVkDDKjqVPB8mcD/GF3/Ov4D9/4Ax5qPrMMAAAAASUVORK5CYII=" alt="To do" /><br />Indicate below the cutoff expression that was chosen in the previous question</p>
<pre class="sourceCode R"><code class="sourceCode r">cutoff &lt;-<span class="st"> </span>... 
## How many genes pass this cutoff in each sample:
<span class="kw">summary</span>(unfilteredExpr &gt;<span class="st"> </span>cutoff)
## For each row return the number of expression values above the cutoff
## This give sthe number of samples in which each gene is expressed above the cutoff 
numSamplesWithExpression &lt;-<span class="st"> </span><span class="kw">apply</span>(unfilteredExpr, <span class="dv">1</span>, function(x){ <span class="kw">return</span>(<span class="kw">sum</span>(x &gt;<span class="st"> </span>cutoff)) })
## Plot this as a histogram
<span class="kw">hist</span>(numSamplesWithExpression)
## Most genes are either expressed in all samples, or in no sample!
## You can for example retain all genes expressed in at least half of the samples:
selectedGenes &lt;-<span class="st"> </span><span class="kw">names</span>(<span class="kw">which</span>(numSamplesWithExpression &gt;=<span class="st"> </span><span class="dv">8</span>))
<span class="kw">length</span>(selectedGenes)</code></pre>
<p>You will now rebuild a new DGE object using only selected genes, and renormalize it<a href="./y.RDa">:</a></p>
<pre class="sourceCode R"><code class="sourceCode r">y &lt;-<span class="st"> </span><span class="kw">DGEList</span>(txi$counts[selectedGenes, ]) 
y &lt;-<span class="st"> </span><span class="kw">calcNormFactors</span>(y)
filteredExpr &lt;-<span class="st"> </span><span class="kw">cpm</span>(y, <span class="dt">log=</span>T)
<span class="kw">plotDensities</span>(filteredExpr, <span class="dt">col=</span>myPalette[<span class="dv">1</span>:<span class="dv">16</span>], <span class="dt">legend=</span><span class="st">&quot;topright&quot;</span>)</code></pre>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAAA3NCSVQICAjb4U/gAAAACXBIWXMAAAEbAAABGwGN907lAAAAGXRFWHRTb2Z0d2FyZQB3d3cuaW5rc2NhcGUub3Jnm+48GgAAALRQTFRF////AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAokSIKwAAADt0Uk5TAAEDBgcICQsMDhATFRcbHSEkJS0uNj5BQkVJU1hfYnN9lZaXmJynwcTGzM/a3+Dh4uXm6O3x8vP1+PpY7DV9AAABVUlEQVQ4y4VTW1uCQBA9KpZiZniBQiwCFLANIZG1zv//Xz3I6qL1MU97Zuc+Z4CzGG4UCylFHLkGbmUcVDxLFYyvvnu+JIvQsy3L9sKClH6v4Z6QqdNRsOOkZKIFmeUsl82Qy5L57OyfU0yva5oK5nWMXkIxuq16JJic6vBZKv/haxC8DlWMkj4AjCVVfntHkjtb1UE5BhAwrRWTA4/r9ZGHSa1IGQBGRafGG25NwNxyUyscVgZcFqr/PVcAsOJezaOgi4hhDfvfZR8AHsn7WhUyQkxPNfa8AAC88UtpPMYQtJv9Lz75rt42BSQt/dvbkvsHhSzKK4O7H/LjCbpBM4VJvmjQptCLPBmYekLGWpt/GISM9EEB6GZZ94I6BV191AAwGGjAYWXoywJgZpmWImXQXDcwJ+cX2p3WrRMGWF6MFWHaKddK2nbatx9O++m1H+//5/8LzCw8IyeUP9gAAAAASUVORK5CYII=" alt="Question" /><br />What has changed now? Do you like the distribution of expression levels and their normalization?</p>
<p>Let's look at the distribution of samples depending on the 2 experimental factors:</p>
<pre class="sourceCode R"><code class="sourceCode r"><span class="kw">plotDensities</span>(filteredExpr, <span class="dt">group=</span>samples$resistance, <span class="dt">col=</span>myPalette[<span class="dv">1</span>:<span class="dv">2</span>])
<span class="kw">plotDensities</span>(filteredExpr, <span class="dt">group=</span>samples$treatment, <span class="dt">col=</span>myPalette[<span class="dv">3</span>:<span class="dv">4</span>])</code></pre>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAAA3NCSVQICAjb4U/gAAAACXBIWXMAAAEbAAABGwGN907lAAAAGXRFWHRTb2Z0d2FyZQB3d3cuaW5rc2NhcGUub3Jnm+48GgAAALRQTFRF////AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAokSIKwAAADt0Uk5TAAEDBgcICQsMDhATFRcbHSEkJS0uNj5BQkVJU1hfYnN9lZaXmJynwcTGzM/a3+Dh4uXm6O3x8vP1+PpY7DV9AAABVUlEQVQ4y4VTW1uCQBA9KpZiZniBQiwCFLANIZG1zv//Xz3I6qL1MU97Zuc+Z4CzGG4UCylFHLkGbmUcVDxLFYyvvnu+JIvQsy3L9sKClH6v4Z6QqdNRsOOkZKIFmeUsl82Qy5L57OyfU0yva5oK5nWMXkIxuq16JJic6vBZKv/haxC8DlWMkj4AjCVVfntHkjtb1UE5BhAwrRWTA4/r9ZGHSa1IGQBGRafGG25NwNxyUyscVgZcFqr/PVcAsOJezaOgi4hhDfvfZR8AHsn7WhUyQkxPNfa8AAC88UtpPMYQtJv9Lz75rt42BSQt/dvbkvsHhSzKK4O7H/LjCbpBM4VJvmjQptCLPBmYekLGWpt/GISM9EEB6GZZ94I6BV191AAwGGjAYWXoywJgZpmWImXQXDcwJ+cX2p3WrRMGWF6MFWHaKddK2nbatx9O++m1H+//5/8LzCw8IyeUP9gAAAAASUVORK5CYII=" alt="Question" /><br />Are there systematic differences in the distribution of expression levels that are linked to one or the other experimental factor? Can you guess which experimental factor is likely to have the strongest effect on expression levels in this experiment?</p>
<h2 id="data-clustering">Data clustering</h2>
<h3 id="pca">PCA</h3>
<p>You will perform a principal component analysis (PCA) on the normalized data using the <code>prcomp</code> R command. Input data of the PCA need to be ~normally distributed, so you will use the logged-CPM values previously plotted.</p>
<pre class="sourceCode R"><code class="sourceCode r">pca &lt;-<span class="st"> </span><span class="kw">prcomp</span>(<span class="kw">t</span>(filteredExpr), <span class="dt">scale =</span> T)
<span class="kw">plot</span>(pca)
<span class="kw">summary</span>(pca)
loadings &lt;-<span class="st"> </span>pca$rotation
scores &lt;-<span class="st"> </span>pca$x</code></pre>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAAA3NCSVQICAjb4U/gAAAACXBIWXMAAAEbAAABGwGN907lAAAAGXRFWHRTb2Z0d2FyZQB3d3cuaW5rc2NhcGUub3Jnm+48GgAAALRQTFRF////AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAokSIKwAAADt0Uk5TAAEDBgcICQsMDhATFRcbHSEkJS0uNj5BQkVJU1hfYnN9lZaXmJynwcTGzM/a3+Dh4uXm6O3x8vP1+PpY7DV9AAABVUlEQVQ4y4VTW1uCQBA9KpZiZniBQiwCFLANIZG1zv//Xz3I6qL1MU97Zuc+Z4CzGG4UCylFHLkGbmUcVDxLFYyvvnu+JIvQsy3L9sKClH6v4Z6QqdNRsOOkZKIFmeUsl82Qy5L57OyfU0yva5oK5nWMXkIxuq16JJic6vBZKv/haxC8DlWMkj4AjCVVfntHkjtb1UE5BhAwrRWTA4/r9ZGHSa1IGQBGRafGG25NwNxyUyscVgZcFqr/PVcAsOJezaOgi4hhDfvfZR8AHsn7WhUyQkxPNfa8AAC88UtpPMYQtJv9Lz75rt42BSQt/dvbkvsHhSzKK4O7H/LjCbpBM4VJvmjQptCLPBmYekLGWpt/GISM9EEB6GZZ94I6BV191AAwGGjAYWXoywJgZpmWImXQXDcwJ+cX2p3WrRMGWF6MFWHaKddK2nbatx9O++m1H+//5/8LzCw8IyeUP9gAAAAASUVORK5CYII=" alt="Question" /><br />What does the <code>scale=T</code> argument means? How much variance is explained by the first 2 principal components? The first 4 principal components? What the <code>scores</code> and <code>loadings</code>?</p>
<p>Plot the samples projected onto the first two principal components.</p>
<pre class="sourceCode R"><code class="sourceCode r"><span class="kw">plot</span>(scores[,<span class="dv">1</span>], scores[,<span class="dv">2</span>])
## OK, here is a bit nicer plot ;)
<span class="kw">plot</span>(scores[,<span class="dv">1</span>], scores[,<span class="dv">2</span>], 
     <span class="dt">xlab=</span><span class="kw">paste0</span>(<span class="st">&quot;PC1: &quot;</span>, <span class="kw">round</span>(<span class="kw">summary</span>(pca)$importance[<span class="dv">2</span>,<span class="dv">1</span>],<span class="dv">3</span>)*<span class="dv">100</span>, <span class="st">&quot;% variance explained&quot;</span>), 
        ## indicate the % variance explained by PC1
     <span class="dt">ylab=</span><span class="kw">paste0</span>(<span class="st">&quot;PC2: &quot;</span>, <span class="kw">round</span>(<span class="kw">summary</span>(pca)$importance[<span class="dv">2</span>,<span class="dv">2</span>],<span class="dv">3</span>)*<span class="dv">100</span>, <span class="st">&quot;% variance explained&quot;</span>), 
        ## indicate the % variance explained by PC2
     <span class="dt">pch=</span><span class="kw">as.numeric</span>(<span class="kw">as.factor</span>(samples$treatment))+<span class="dv">15</span>,
        ## points shape according to treatment
     <span class="dt">col=</span>myPalette[<span class="kw">as.numeric</span>(<span class="kw">as.factor</span>(samples$resistance))], 
        ## points color according to susceptibility
     <span class="dt">xlim=</span><span class="kw">c</span>(<span class="kw">min</span>(scores[,<span class="dv">1</span>]), <span class="kw">max</span>(scores[,<span class="dv">1</span>])) ,
     <span class="dt">ylim=</span><span class="kw">c</span>(<span class="kw">min</span>(scores[,<span class="dv">2</span>]), <span class="kw">max</span>(scores[,<span class="dv">2</span>])+(<span class="kw">max</span>(scores[,<span class="dv">2</span>])-<span class="kw">min</span>(scores[,<span class="dv">2</span>]))/<span class="dv">4</span>) 
        ## Let a bit of room on top of the plot for legend
)
## Plot legends
<span class="kw">legend</span>(<span class="st">&quot;topleft&quot;</span>, <span class="dt">legend=</span><span class="kw">levels</span>(<span class="kw">as.factor</span>(samples$treatment)), <span class="dt">pch=</span><span class="dv">16</span>:<span class="dv">17</span>)
<span class="kw">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="dt">legend=</span><span class="kw">levels</span>(<span class="kw">as.factor</span>(samples$resistance)), <span class="dt">pch=</span><span class="kw">c</span>(<span class="dv">16</span>,<span class="dv">16</span>), <span class="dt">col=</span>myPalette[<span class="dv">1</span>:<span class="dv">2</span>])</code></pre>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAAA3NCSVQICAjb4U/gAAAACXBIWXMAAAEbAAABGwGN907lAAAAGXRFWHRTb2Z0d2FyZQB3d3cuaW5rc2NhcGUub3Jnm+48GgAAALRQTFRF////AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAokSIKwAAADt0Uk5TAAEDBgcICQsMDhATFRcbHSEkJS0uNj5BQkVJU1hfYnN9lZaXmJynwcTGzM/a3+Dh4uXm6O3x8vP1+PpY7DV9AAABVUlEQVQ4y4VTW1uCQBA9KpZiZniBQiwCFLANIZG1zv//Xz3I6qL1MU97Zuc+Z4CzGG4UCylFHLkGbmUcVDxLFYyvvnu+JIvQsy3L9sKClH6v4Z6QqdNRsOOkZKIFmeUsl82Qy5L57OyfU0yva5oK5nWMXkIxuq16JJic6vBZKv/haxC8DlWMkj4AjCVVfntHkjtb1UE5BhAwrRWTA4/r9ZGHSa1IGQBGRafGG25NwNxyUyscVgZcFqr/PVcAsOJezaOgi4hhDfvfZR8AHsn7WhUyQkxPNfa8AAC88UtpPMYQtJv9Lz75rt42BSQt/dvbkvsHhSzKK4O7H/LjCbpBM4VJvmjQptCLPBmYekLGWpt/GISM9EEB6GZZ94I6BV191AAwGGjAYWXoywJgZpmWImXQXDcwJ+cX2p3WrRMGWF6MFWHaKddK2nbatx9O++m1H+//5/8LzCw8IyeUP9gAAAAASUVORK5CYII=" alt="Question" /><br />What experimental factor does correlate with PC1? What is special about PC2? It could be useful to add sample names with the following command (the + 5 allows to put the labels next to the points and not on the points)</p>
<pre class="sourceCode R"><code class="sourceCode r"><span class="kw">text</span>(scores[,<span class="dv">1</span>], scores[,<span class="dv">2</span>] +<span class="st"> </span><span class="dv">5</span>, samples$title)</code></pre>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAAuQAAALkB4qdB6AAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAMxSURBVFiFvZfNS5RRFMZ/Z2YIPxPCKBEyUAQ3gvQlrQInWrQQgoSWLXQVWCH9Ca1atPBPqAgSXEsSIglRCi4Cg0RmM5pYUYr4UXhavOdlrnfu+zpvWAcOM/Occ57zzJn73ntHVBURmQYOgNuq+pN/aCLSArwCcqpaLBh+AFwHpkTkRpoIETkJXAQuAZcNfg98AOZVdfOI5lPAFeA1AKoK0AK8A9ReG1QV14Eu4I2J1QQ/sJyuQH2D16NFVXETXBFFB88B94Fti60Az4BR4Kr5qGErlrNtWM7hKfrNDwlwVBaBvH1uBGatcBd4FMdCDuQtZ9dqZoFGJ1b0pxskcgjHjWge6EnL9ep6rEaB8dTcFJIB+03XgdZamzv1rVZ7AAxkEgA0AyX7BreyNnd4bhlHCWjOImDECl/+bXOH66VxjYTiOcJ2wV6fJ8SzWMxxIRQ8SsDCMQiIOYICxMZUAUROAFvAd1VtOwYBiMgacIpoHey7sdAEOoATwPJxNDdbNs4OP1CozqXsCKkyETkDJE1mTVXXA3jMVa6KJKzcVaKV2+Th56hsySHfBs55NU0WWw31Ck0A4KN9y35g2sE3qUxtAdiw96eJFlnBclzrdzir7YgNZC4Qm7DYAwd7YNhEIH+OlA0tSUAO+GyFg17spuGTDjZp2E0vd9Dwzzgn45ECrHjIijeAXgfPEz2m3wAx/2ZY3snrtVoFhjKdBQ7JYyP4CvQ5eHzunzJXYMWJ91mNAo9Te3gN24F7QL19FuCFEe0AT4kW54JhZ83VsDbL2THsBZXNrt6424MCgPNUTsCiJ2zYRhwL+WHv75qrYXHjLWDY44hvRCXg/CEBXvNXBG49QDfJz7/v3YH6vHEfEhEHF53mhYT1UGc5ZeAa0ZH9xHzEsLLl1CVwFBwRi+5G9Jbo/vZQVX+Tbr9UdQaY8QMi8iutUFV/i8gdYI34HEpboQkTKKXklNImEPKk+8B/s6SzIM3aReRTUiwrWdWFJDFRpI7oMavF6lV1t5bELD/BHtHFYg/oJNpYXO/0cmqzWheLTWqMaJHtA18837fYWCbOjAIaiP4nLlG9+SxZrOqPbZr/Acin3r66y1JbAAAAAElFTkSuQmCC" alt="Tip" /><br />When labels get too messy, it can be nice to only label the interesting points. The command <code>identify(scores[,1], scores[,2], samples$title)</code> allows you to click on the points to reveal their labels. You can also influence the way the labels are placed by clicking slightly above/below/left/right of a point. Press escape to exit the clicking mode.</p>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAA7AAAAOwBeShxvQAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAJGSURBVFiFxZc7aBVBFEDPjc+ACn6wEfJR/EBAKxE1xg/YiHY2Bq1UsBV7QbBUlDSS1FYiEtBC0UJfDGga0U4t/GvjB+QZFMTPtXizOF5mdmb3Bd/ALd7uvfec3dk3syuqSjdHT1fpnQiIiGTk9IjIThHZGE1S1dIAlgDDwFHgHHADeAl8A64CQ5G63cBrQF3cD+YFCnuB08AxoOk1iMUboGF6jAK/TN7tpICDX8uA+nHT9NgBfLdwYGGOwHhFeNM2Bi6ZnHsxeEjgQgX4FLDI1AvwyeQdCUyzAMeBPv/gWuBtJnzawl2PZYHch8BSAy/u9EQd+Ge/oREYjNQ8cHI+XIH3VeFFXME8+U5gU0nNR+CJOTYJ8LgiPCgBrAgAUrEH4GJNgUJiXk342WIfarhGsUS7oPgxVhN+6p+/YYnEXWAD8Kom/CswA9wCLgMngHXBdSAg0cT91YBVRiIHPgtsT+415iluABO0VzO7whUSufCRFDy4GSV2xuUZ8C+5cFWt/D4w303NUOT8LLAXQEQaWR0rXH3OlW8DDgA/iCxWtaagAnwU+OkdT0rMFXwYOGjgWRKdwlsOvj8CT0p0DHe5/cCzktyoRAzeS/km1QK2mpoB4HlC4mSuwCFXcAbYB3wogxuJFyUC7+xdiAlMuoI+87sFbEk8N4MJidU5Aof5uxmdp/2Wm4R79StpfztY+HTuFCwA7niFj4DNOXAjcR347Xo8BXbZPHHJwSEi64HFqjoTTUoMEVkDDKjqVPB8mcD/GF3/Ov4D9/4Ax5qPrMMAAAAASUVORK5CYII=" alt="To do" /><br />Plot the samples projected onto PC2 and PC3, then PC3 and PC4. Do you observe segregation of the points by any experimental factor? Are these observations consistent with your previous prediction of the experimental factor with the strongest effect on expression levels?</p>
<h3 id="heatmap-skip-this-part-if-timing-is-tight">Heatmap (skip this part if timing is tight)</h3>
<p>Another way to visualize the data is to plot a heatmap of expression levels, along with a dendrogram obtained by hierarchical clustering of the samples. The <code>heatmap</code> R function allows you to perform this, but the <code>heatmap.2</code> from the <code>gplots</code> package offers more possibilities. There a lot more packages and heatmap functions to explore if you have particular needs. You will first plot a heatmap using a random selection of 100 genes:</p>
<pre class="sourceCode R"><code class="sourceCode r"><span class="kw">library</span>(gplots)
## create a gradient of 100 colors going from light blue to dark blue
colors &lt;-<span class="st"> </span><span class="kw">colorRampPalette</span>(<span class="kw">c</span>(<span class="kw">brewer.pal</span>(<span class="dv">9</span>, <span class="st">&quot;Blues&quot;</span>)[<span class="dv">1</span>],<span class="kw">brewer.pal</span>(<span class="dv">9</span>, <span class="st">&quot;Blues&quot;</span>)[<span class="dv">9</span>]))(<span class="dv">100</span>)
## select randomly 100 genes and extract their expression
selectedExpression &lt;-<span class="st"> </span>filteredExpr[<span class="kw">sample</span>(<span class="dv">1</span>:<span class="kw">length</span>(filteredExpr[,<span class="dv">1</span>]), <span class="dv">100</span>),]
## Plot the heatmap
<span class="kw">heatmap.2</span>(selectedExpression, <span class="dt">scale=</span><span class="st">&quot;none&quot;</span>, <span class="dt">col =</span> colors, <span class="dt">margins =</span> <span class="kw">c</span>(<span class="dv">14</span>, <span class="dv">6</span>), <span class="dt">trace=</span><span class="st">'none'</span>, <span class="dt">denscol=</span><span class="st">&quot;white&quot;</span>)</code></pre>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAAA3NCSVQICAjb4U/gAAAACXBIWXMAAAEbAAABGwGN907lAAAAGXRFWHRTb2Z0d2FyZQB3d3cuaW5rc2NhcGUub3Jnm+48GgAAALRQTFRF////AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAokSIKwAAADt0Uk5TAAEDBgcICQsMDhATFRcbHSEkJS0uNj5BQkVJU1hfYnN9lZaXmJynwcTGzM/a3+Dh4uXm6O3x8vP1+PpY7DV9AAABVUlEQVQ4y4VTW1uCQBA9KpZiZniBQiwCFLANIZG1zv//Xz3I6qL1MU97Zuc+Z4CzGG4UCylFHLkGbmUcVDxLFYyvvnu+JIvQsy3L9sKClH6v4Z6QqdNRsOOkZKIFmeUsl82Qy5L57OyfU0yva5oK5nWMXkIxuq16JJic6vBZKv/haxC8DlWMkj4AjCVVfntHkjtb1UE5BhAwrRWTA4/r9ZGHSa1IGQBGRafGG25NwNxyUyscVgZcFqr/PVcAsOJezaOgi4hhDfvfZR8AHsn7WhUyQkxPNfa8AAC88UtpPMYQtJv9Lz75rt42BSQt/dvbkvsHhSzKK4O7H/LjCbpBM4VJvmjQptCLPBmYekLGWpt/GISM9EEB6GZZ94I6BV191AAwGGjAYWXoywJgZpmWImXQXDcwJ+cX2p3WrRMGWF6MFWHaKddK2nbatx9O++m1H+//5/8LzCw8IyeUP9gAAAAASUVORK5CYII=" alt="Question" /><br />What are the rows and the left tree representing? What are the columns and the top tree representing? What does the color intensity mean? Try to replot the heatmap with a new random selection of 100 genes. Is the clustering stable?</p>
<p>It is difficult to include the expression of all genes to create a readable heatmap. An alternative is to calculate the matrix of pairwise correlation coefficients across all samples and plot a heatmap of this matrix. In addition, the <code>ColSideColors</code> and <code>RowSideColors</code> arguments allow to better visualize the experimental factors of each sample:</p>
<pre class="sourceCode R"><code class="sourceCode r">allCors &lt;-<span class="st"> </span><span class="kw">cor</span>(filteredExpr, <span class="dt">method=</span><span class="st">&quot;spearman&quot;</span>, <span class="dt">use=</span><span class="st">&quot;pairwise.complete.obs&quot;</span>)
<span class="kw">heatmap.2</span>( allCors, <span class="dt">scale=</span><span class="st">&quot;none&quot;</span>, <span class="dt">col =</span> colors, <span class="dt">margins =</span> <span class="kw">c</span>(<span class="dv">16</span>, <span class="dv">12</span>), <span class="dt">trace=</span><span class="st">'none'</span>, <span class="dt">denscol=</span><span class="st">&quot;white&quot;</span>, 
           <span class="dt">RowSideColors=</span>myPalette[<span class="dv">1</span>:<span class="dv">2</span>][<span class="kw">as.integer</span>(<span class="kw">as.factor</span>(samples$resistance))], 
           <span class="dt">ColSideColors=</span>myPalette[<span class="dv">3</span>:<span class="dv">4</span>][<span class="kw">as.integer</span>(<span class="kw">as.factor</span>(samples$treatment))])</code></pre>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAAA3NCSVQICAjb4U/gAAAACXBIWXMAAAEbAAABGwGN907lAAAAGXRFWHRTb2Z0d2FyZQB3d3cuaW5rc2NhcGUub3Jnm+48GgAAALRQTFRF////AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAokSIKwAAADt0Uk5TAAEDBgcICQsMDhATFRcbHSEkJS0uNj5BQkVJU1hfYnN9lZaXmJynwcTGzM/a3+Dh4uXm6O3x8vP1+PpY7DV9AAABVUlEQVQ4y4VTW1uCQBA9KpZiZniBQiwCFLANIZG1zv//Xz3I6qL1MU97Zuc+Z4CzGG4UCylFHLkGbmUcVDxLFYyvvnu+JIvQsy3L9sKClH6v4Z6QqdNRsOOkZKIFmeUsl82Qy5L57OyfU0yva5oK5nWMXkIxuq16JJic6vBZKv/haxC8DlWMkj4AjCVVfntHkjtb1UE5BhAwrRWTA4/r9ZGHSa1IGQBGRafGG25NwNxyUyscVgZcFqr/PVcAsOJezaOgi4hhDfvfZR8AHsn7WhUyQkxPNfa8AAC88UtpPMYQtJv9Lz75rt42BSQt/dvbkvsHhSzKK4O7H/LjCbpBM4VJvmjQptCLPBmYekLGWpt/GISM9EEB6GZZ94I6BV191AAwGGjAYWXoywJgZpmWImXQXDcwJ+cX2p3WrRMGWF6MFWHaKddK2nbatx9O++m1H+//5/8LzCw8IyeUP9gAAAAASUVORK5CYII=" alt="Question" /><br />What are the rows and the columns representing now? What does the color intensity mean? Is the clustering pattern consistent with the PCA? Do you see a manifestation of the DGRP line effect on the heatmap?</p>
<h2 id="differential-expression-analysis">Differential expression analysis</h2>
<h3 id="some-background">Some background</h3>
<p>There are several softwares to test for differential expression. <code>DESeq2</code> and <code>edgeR</code> are very good, but here you will use the <code>limma-voom</code> method, introduced in this paper:</p>
<p>Law C, Chen Y, Shi W, Smyth G. voom: precision weights unlock linear model analysis tools for RNA-seq read counts. <em>Genome Biology</em>. 2014;15(2):R29 (<a href="http://genomebiology.biomedcentral.com/articles/10.1186/gb-2014-15-2-r29">http://genomebiology.biomedcentral.com/articles/10.1186/gb-2014-15-2-r29</a>). A PDF of the paper is located in the <code>~/data/papers/</code> folder.</p>
<p>While <code>DESeq2</code> and <code>edgeR</code> work directly on count distributions, using a negative binomial modeling framework, <code>limma-voom</code> works on the log-transformed CPMs, which are normally distributed data. This is very useful because the theory behind of normal distributions is more tractable. Notably, a large range of statistical methods that were developped for microarray analysis can be used on such normally distributed data. For example, the widely used <code>limma</code> package uses an empirical Bayes approach, which borrows information across genes to adjust variance estimates when sample sizes are small. <code>Limma</code> is a very comprehensive package, able to deal with experiments with complex designs.</p>
<p>A problem of the log-transformation is that it does not yield stable variances (i.e., there is heteroscedasticity). The variability of genes with lower expression is lower than those with high expression, This is easily observable when plotting one sample versus a biological replicate:</p>
<pre class="sourceCode R"><code class="sourceCode r">## The color argument was set up to plot transparent black points 
<span class="kw">plot</span>(filteredExpr[,<span class="dv">5</span>], filteredExpr[,<span class="dv">6</span>], <span class="dt">pch=</span><span class="dv">16</span>, <span class="dt">col=</span><span class="kw">rgb</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="fl">0.2</span>))</code></pre>
<p>To deal with this problem, <code>limma-voom</code> models the mean-variance relationship observed in the data. This trend is incorporated into a precision weight for each individual normalized observation, which are proportional to the expression levels (see <a href="https://en.wikipedia.org/wiki/Least_squares#Weighted_least_squares">https://en.wikipedia.org/wiki/Least_squares#Weighted_least_squares</a>). These weights can be used in <code>limma</code> during its linear modeling step. <code>Limma-voom</code> was shown to perform equally well compared to tools based on the negative-binomial distribution modeling, or even better when the sequencing depths are different across samples.</p>
<p>An additional interesting possibility offered by the <code>limma</code> package is the possibility to adjust the <code>limma-voom</code> precision weights to deal with variations in sample quality, frequently encountered in RNA-seq experiments. Removal of high variation samples reduces noise but leads to a loss of power. A compromise is to use all samples, but to down-weight the observations from more variable samples. This is implemented in the <code>voomWithQualityWeights</code> function, described in the following paper:</p>
<p>Liu R, et al. Why weight? Modelling sample and observational level variability improves power in RNA-seq analyses. <em>Nucleic Acids Res</em>. 2015;43(15):e97 (<a href="http://nar.oxfordjournals.org/content/43/15/e97.long">http://nar.oxfordjournals.org/content/43/15/e97.long</a>). A PDF of the paper is located in the <code>~/data/papers/</code> folder.</p>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAAA3NCSVQICAjb4U/gAAAACXBIWXMAAAEbAAABGwGN907lAAAAGXRFWHRTb2Z0d2FyZQB3d3cuaW5rc2NhcGUub3Jnm+48GgAAALRQTFRF////AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAokSIKwAAADt0Uk5TAAEDBgcICQsMDhATFRcbHSEkJS0uNj5BQkVJU1hfYnN9lZaXmJynwcTGzM/a3+Dh4uXm6O3x8vP1+PpY7DV9AAABVUlEQVQ4y4VTW1uCQBA9KpZiZniBQiwCFLANIZG1zv//Xz3I6qL1MU97Zuc+Z4CzGG4UCylFHLkGbmUcVDxLFYyvvnu+JIvQsy3L9sKClH6v4Z6QqdNRsOOkZKIFmeUsl82Qy5L57OyfU0yva5oK5nWMXkIxuq16JJic6vBZKv/haxC8DlWMkj4AjCVVfntHkjtb1UE5BhAwrRWTA4/r9ZGHSa1IGQBGRafGG25NwNxyUyscVgZcFqr/PVcAsOJezaOgi4hhDfvfZR8AHsn7WhUyQkxPNfa8AAC88UtpPMYQtJv9Lz75rt42BSQt/dvbkvsHhSzKK4O7H/LjCbpBM4VJvmjQptCLPBmYekLGWpt/GISM9EEB6GZZ94I6BV191AAwGGjAYWXoywJgZpmWImXQXDcwJ+cX2p3WrRMGWF6MFWHaKddK2nbatx9O++m1H+//5/8LzCw8IyeUP9gAAAAASUVORK5CYII=" alt="Question" /><br />Following the PCA results, do you think this procedure will be beneficial?</p>
<h3 id="implementation">Implementation</h3>
<pre class="sourceCode R"><code class="sourceCode r">## Limma-voom requires the specification of a design matrix. 
## It is simpler to create a single factor made of the combination of the 2 factors of interest: 
## susceptibility and treatment
condition &lt;-<span class="st"> </span><span class="kw">factor</span>(<span class="kw">paste</span>(samples$treatment, samples$resistance, <span class="dt">sep=</span><span class="st">&quot;.&quot;</span>))
## Build the design matrix:
design &lt;-<span class="st"> </span><span class="kw">model.matrix</span>(~<span class="st"> </span><span class="dv">0</span> +<span class="st"> </span>condition) 
## The &quot;~ 0 + ...&quot; syntax is optional, but it will later allow an easier specification of the 
## contrasts for differential expression
## Simplify design matrix column names:
<span class="kw">colnames</span>(design) &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&quot;condition&quot;</span>, <span class="st">&quot;&quot;</span>, <span class="kw">colnames</span>(design))
## Apply the limma-voom method:
v &lt;-<span class="st"> </span><span class="kw">voomWithQualityWeights</span>(y, design, <span class="dt">plot=</span>T)</code></pre>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAAA3NCSVQICAjb4U/gAAAACXBIWXMAAAEbAAABGwGN907lAAAAGXRFWHRTb2Z0d2FyZQB3d3cuaW5rc2NhcGUub3Jnm+48GgAAALRQTFRF////AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAokSIKwAAADt0Uk5TAAEDBgcICQsMDhATFRcbHSEkJS0uNj5BQkVJU1hfYnN9lZaXmJynwcTGzM/a3+Dh4uXm6O3x8vP1+PpY7DV9AAABVUlEQVQ4y4VTW1uCQBA9KpZiZniBQiwCFLANIZG1zv//Xz3I6qL1MU97Zuc+Z4CzGG4UCylFHLkGbmUcVDxLFYyvvnu+JIvQsy3L9sKClH6v4Z6QqdNRsOOkZKIFmeUsl82Qy5L57OyfU0yva5oK5nWMXkIxuq16JJic6vBZKv/haxC8DlWMkj4AjCVVfntHkjtb1UE5BhAwrRWTA4/r9ZGHSa1IGQBGRafGG25NwNxyUyscVgZcFqr/PVcAsOJezaOgi4hhDfvfZR8AHsn7WhUyQkxPNfa8AAC88UtpPMYQtJv9Lz75rt42BSQt/dvbkvsHhSzKK4O7H/LjCbpBM4VJvmjQptCLPBmYekLGWpt/GISM9EEB6GZZ94I6BV191AAwGGjAYWXoywJgZpmWImXQXDcwJ+cX2p3WrRMGWF6MFWHaKddK2nbatx9O++m1H+//5/8LzCw8IyeUP9gAAAAASUVORK5CYII=" alt="Question" /><br />What are the generated plots indicating? Which sample(s) are the most down-weighted?</p>
<h3 id="linear-modeling-and-extraction-of-interesting-contrasts">Linear modeling and extraction of interesting contrasts</h3>
<p>Please refer to the very nice user guide for <code>limma</code> for details on the analysis, or to adapt this pipeline to analyze your own data (<a href="http://www.bioconductor.org/packages/release/bioc/vignettes/limma/inst/doc/usersguide.pdf">http://www.bioconductor.org/packages/release/bioc/vignettes/limma/inst/doc/usersguide.pdf</a>)</p>
<pre class="sourceCode R"><code class="sourceCode r">fit &lt;-<span class="st"> </span><span class="kw">lmFit</span>(v)</code></pre>
<p>The next step is to specify the contrasts of interest in a contrast matrix. You can choose the names of the contrasts yourself (for example see below <code>treatmentInS</code>). To specify what the contrast will be comparing, you need to build a linear combinations of the design matrix column names. This means you need to choose among the following 4 terms: <code>Challenged.Resistant</code>, <code>Unchallenged.Resistant</code>, <code>Challenged.Susceptible</code> and <code>Unchallenged.Susceptible</code>. I have specified below the 3 following interesting contrasts:</p>
<ul class="incremental">
<li>the treatment effect in resistant lines: <code>treatmentInR</code><br /></li>
<li>the treatment effect in susceptible lines: <code>treatmentInS</code><br /></li>
<li>the treatment effect in general: <code>treatment</code></li>
</ul>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAA7AAAAOwBeShxvQAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAJGSURBVFiFxZc7aBVBFEDPjc+ACn6wEfJR/EBAKxE1xg/YiHY2Bq1UsBV7QbBUlDSS1FYiEtBC0UJfDGga0U4t/GvjB+QZFMTPtXizOF5mdmb3Bd/ALd7uvfec3dk3syuqSjdHT1fpnQiIiGTk9IjIThHZGE1S1dIAlgDDwFHgHHADeAl8A64CQ5G63cBrQF3cD+YFCnuB08AxoOk1iMUboGF6jAK/TN7tpICDX8uA+nHT9NgBfLdwYGGOwHhFeNM2Bi6ZnHsxeEjgQgX4FLDI1AvwyeQdCUyzAMeBPv/gWuBtJnzawl2PZYHch8BSAy/u9EQd+Ge/oREYjNQ8cHI+XIH3VeFFXME8+U5gU0nNR+CJOTYJ8LgiPCgBrAgAUrEH4GJNgUJiXk342WIfarhGsUS7oPgxVhN+6p+/YYnEXWAD8Kom/CswA9wCLgMngHXBdSAg0cT91YBVRiIHPgtsT+415iluABO0VzO7whUSufCRFDy4GSV2xuUZ8C+5cFWt/D4w303NUOT8LLAXQEQaWR0rXH3OlW8DDgA/iCxWtaagAnwU+OkdT0rMFXwYOGjgWRKdwlsOvj8CT0p0DHe5/cCzktyoRAzeS/km1QK2mpoB4HlC4mSuwCFXcAbYB3wogxuJFyUC7+xdiAlMuoI+87sFbEk8N4MJidU5Aof5uxmdp/2Wm4R79StpfztY+HTuFCwA7niFj4DNOXAjcR347Xo8BXbZPHHJwSEi64HFqjoTTUoMEVkDDKjqVPB8mcD/GF3/Ov4D9/4Ax5qPrMMAAAAASUVORK5CYII=" alt="To do" /><br />Following the same logic, please complete the R command to add the contrasts for:</p>
<ul class="incremental">
<li>the resistance effect in challenged lines: <code>resistanceInC</code><br /></li>
<li>the resistance effect in unchallenged lines: <code>resistanceInU</code><br /></li>
<li><p>the resistance effect in general: <code>resistance</code></p>
<pre class="sourceCode R"><code class="sourceCode r">cont.matrix &lt;-<span class="st"> </span><span class="kw">makeContrasts</span>(
                             <span class="dt">treatmentInR  =</span> Challenged.Resistant -<span class="st"> </span>Unchallenged.Resistant,
                             <span class="dt">treatmentInS  =</span> Challenged.Susceptible -<span class="st"> </span>Unchallenged.Susceptible,
                             <span class="dt">treatment     =</span> (Challenged.Resistant +<span class="st"> </span>Challenged.Susceptible) 
                                         -<span class="st"> </span>(Unchallenged.Resistant +<span class="st"> </span>Unchallenged.Susceptible),
                         <span class="dt">resistanceInC =</span> [...],
                         <span class="dt">resistanceInU =</span> [...],
                         <span class="dt">resistance    =</span> [...],
                         <span class="dt">levels=</span>design)
cont.matrix</code></pre>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAAA3NCSVQICAjb4U/gAAAACXBIWXMAAAEbAAABGwGN907lAAAAGXRFWHRTb2Z0d2FyZQB3d3cuaW5rc2NhcGUub3Jnm+48GgAAALRQTFRF////AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAokSIKwAAADt0Uk5TAAEDBgcICQsMDhATFRcbHSEkJS0uNj5BQkVJU1hfYnN9lZaXmJynwcTGzM/a3+Dh4uXm6O3x8vP1+PpY7DV9AAABVUlEQVQ4y4VTW1uCQBA9KpZiZniBQiwCFLANIZG1zv//Xz3I6qL1MU97Zuc+Z4CzGG4UCylFHLkGbmUcVDxLFYyvvnu+JIvQsy3L9sKClH6v4Z6QqdNRsOOkZKIFmeUsl82Qy5L57OyfU0yva5oK5nWMXkIxuq16JJic6vBZKv/haxC8DlWMkj4AjCVVfntHkjtb1UE5BhAwrRWTA4/r9ZGHSa1IGQBGRafGG25NwNxyUyscVgZcFqr/PVcAsOJezaOgi4hhDfvfZR8AHsn7WhUyQkxPNfa8AAC88UtpPMYQtJv9Lz75rt42BSQt/dvbkvsHhSzKK4O7H/LjCbpBM4VJvmjQptCLPBmYekLGWpt/GISM9EEB6GZZ94I6BV191AAwGGjAYWXoywJgZpmWImXQXDcwJ+cX2p3WrRMGWF6MFWHaKddK2nbatx9O++m1H+//5/8LzCw8IyeUP9gAAAAASUVORK5CYII=" alt="Question" /><br />Which contrasts do you think are the most interesting with respect to the biological question of the original study?</p></li>
</ul>
<p>You can now extract the lists of genes differentially expressed for each contrast, at a 10% FDR.</p>
<pre class="sourceCode R"><code class="sourceCode r">fit2 &lt;-<span class="st"> </span><span class="kw">contrasts.fit</span>(fit, cont.matrix)
fit2 &lt;-<span class="st"> </span><span class="kw">eBayes</span>(fit2)
results &lt;-<span class="st"> </span><span class="kw">decideTests</span>(fit2, <span class="dt">p.value=</span><span class="fl">0.1</span>) 
<span class="kw">summary</span>(results)</code></pre>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAAA3NCSVQICAjb4U/gAAAACXBIWXMAAAEbAAABGwGN907lAAAAGXRFWHRTb2Z0d2FyZQB3d3cuaW5rc2NhcGUub3Jnm+48GgAAALRQTFRF////AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAokSIKwAAADt0Uk5TAAEDBgcICQsMDhATFRcbHSEkJS0uNj5BQkVJU1hfYnN9lZaXmJynwcTGzM/a3+Dh4uXm6O3x8vP1+PpY7DV9AAABVUlEQVQ4y4VTW1uCQBA9KpZiZniBQiwCFLANIZG1zv//Xz3I6qL1MU97Zuc+Z4CzGG4UCylFHLkGbmUcVDxLFYyvvnu+JIvQsy3L9sKClH6v4Z6QqdNRsOOkZKIFmeUsl82Qy5L57OyfU0yva5oK5nWMXkIxuq16JJic6vBZKv/haxC8DlWMkj4AjCVVfntHkjtb1UE5BhAwrRWTA4/r9ZGHSa1IGQBGRafGG25NwNxyUyscVgZcFqr/PVcAsOJezaOgi4hhDfvfZR8AHsn7WhUyQkxPNfa8AAC88UtpPMYQtJv9Lz75rt42BSQt/dvbkvsHhSzKK4O7H/LjCbpBM4VJvmjQptCLPBmYekLGWpt/GISM9EEB6GZZ94I6BV191AAwGGjAYWXoywJgZpmWImXQXDcwJ+cX2p3WrRMGWF6MFWHaKddK2nbatx9O++m1H+//5/8LzCw8IyeUP9gAAAAASUVORK5CYII=" alt="Question" /><br />What do you observe? Is it consistent with the PCA? What is surprising?</p>
<p>You can see how many genes are differentially expressed in common between 2 contrast using Venn diagrams:</p>
<pre class="sourceCode R"><code class="sourceCode r"><span class="kw">vennDiagram</span>(results[,<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)])
<span class="kw">vennDiagram</span>(results[,<span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">5</span>)])
<span class="kw">vennDiagram</span>(results[,<span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">6</span>)])</code></pre>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAAA3NCSVQICAjb4U/gAAAACXBIWXMAAAEbAAABGwGN907lAAAAGXRFWHRTb2Z0d2FyZQB3d3cuaW5rc2NhcGUub3Jnm+48GgAAALRQTFRF////AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAokSIKwAAADt0Uk5TAAEDBgcICQsMDhATFRcbHSEkJS0uNj5BQkVJU1hfYnN9lZaXmJynwcTGzM/a3+Dh4uXm6O3x8vP1+PpY7DV9AAABVUlEQVQ4y4VTW1uCQBA9KpZiZniBQiwCFLANIZG1zv//Xz3I6qL1MU97Zuc+Z4CzGG4UCylFHLkGbmUcVDxLFYyvvnu+JIvQsy3L9sKClH6v4Z6QqdNRsOOkZKIFmeUsl82Qy5L57OyfU0yva5oK5nWMXkIxuq16JJic6vBZKv/haxC8DlWMkj4AjCVVfntHkjtb1UE5BhAwrRWTA4/r9ZGHSa1IGQBGRafGG25NwNxyUyscVgZcFqr/PVcAsOJezaOgi4hhDfvfZR8AHsn7WhUyQkxPNfa8AAC88UtpPMYQtJv9Lz75rt42BSQt/dvbkvsHhSzKK4O7H/LjCbpBM4VJvmjQptCLPBmYekLGWpt/GISM9EEB6GZZ94I6BV191AAwGGjAYWXoywJgZpmWImXQXDcwJ+cX2p3WrRMGWF6MFWHaKddK2nbatx9O++m1H+//5/8LzCw8IyeUP9gAAAAASUVORK5CYII=" alt="Question" /><br />What can you conclude about the overlap between lists of DE genes. Do these results make sense?</p>
<h3 id="extraction-of-differentially-expressed-genes">Extraction of differentially expressed genes</h3>
<p>To extract the lists of differentially expressed genes, the <code>coef</code> argument is needed. It corresponds to the column number of the contrast matrix.</p>
<pre class="sourceCode R"><code class="sourceCode r">## Treatment:
treatmentGenes &lt;-<span class="st"> </span><span class="kw">topTable</span>(fit2, <span class="dt">coef=</span><span class="dv">3</span>, <span class="dt">p.value=</span><span class="fl">0.1</span>, <span class="dt">number=</span><span class="ot">Inf</span>, <span class="dt">sort.by=</span><span class="st">&quot;P&quot;</span>)
## visualize the top 100 genes
selectedExpression &lt;-<span class="st"> </span>filteredExpr[<span class="kw">rownames</span>(treatmentGenes)[<span class="dv">1</span>:<span class="dv">100</span>],]
<span class="kw">heatmap.2</span>(selectedExpression, <span class="dt">scale=</span><span class="st">&quot;none&quot;</span>, <span class="dt">col =</span> colors, <span class="dt">margins =</span> <span class="kw">c</span>(<span class="dv">14</span>, <span class="dv">6</span>), <span class="dt">trace=</span><span class="st">'none'</span>, <span class="dt">denscol=</span><span class="st">&quot;white&quot;</span>, 
          <span class="dt">ColSideColors=</span>myPalette[<span class="dv">3</span>:<span class="dv">4</span>][<span class="kw">as.integer</span>(<span class="kw">as.factor</span>(samples$treatment))])
## Resistance:
resistanceGenes &lt;-<span class="st"> </span><span class="kw">topTable</span>(fit2, <span class="dt">coef=</span><span class="dv">6</span>, <span class="dt">p.value=</span><span class="fl">0.1</span>, <span class="dt">number=</span><span class="ot">Inf</span>, <span class="dt">sort.by=</span><span class="st">&quot;P&quot;</span>)
## visualize all DE genes
selectedExpression &lt;-<span class="st"> </span>filteredExpr[<span class="kw">rownames</span>(resistanceGenes),]
<span class="kw">heatmap.2</span>(selectedExpression, <span class="dt">scale=</span><span class="st">&quot;none&quot;</span>, <span class="dt">col =</span> colors, <span class="dt">margins =</span> <span class="kw">c</span>(<span class="dv">14</span>, <span class="dv">6</span>), <span class="dt">trace=</span><span class="st">'none'</span>, <span class="dt">denscol=</span><span class="st">&quot;white&quot;</span>, 
          <span class="dt">ColSideColors=</span>myPalette[<span class="dv">1</span>:<span class="dv">2</span>][<span class="kw">as.integer</span>(<span class="kw">as.factor</span>(samples$resistance))])</code></pre>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAAA3NCSVQICAjb4U/gAAAACXBIWXMAAAEbAAABGwGN907lAAAAGXRFWHRTb2Z0d2FyZQB3d3cuaW5rc2NhcGUub3Jnm+48GgAAALRQTFRF////AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAokSIKwAAADt0Uk5TAAEDBgcICQsMDhATFRcbHSEkJS0uNj5BQkVJU1hfYnN9lZaXmJynwcTGzM/a3+Dh4uXm6O3x8vP1+PpY7DV9AAABVUlEQVQ4y4VTW1uCQBA9KpZiZniBQiwCFLANIZG1zv//Xz3I6qL1MU97Zuc+Z4CzGG4UCylFHLkGbmUcVDxLFYyvvnu+JIvQsy3L9sKClH6v4Z6QqdNRsOOkZKIFmeUsl82Qy5L57OyfU0yva5oK5nWMXkIxuq16JJic6vBZKv/haxC8DlWMkj4AjCVVfntHkjtb1UE5BhAwrRWTA4/r9ZGHSa1IGQBGRafGG25NwNxyUyscVgZcFqr/PVcAsOJezaOgi4hhDfvfZR8AHsn7WhUyQkxPNfa8AAC88UtpPMYQtJv9Lz75rt42BSQt/dvbkvsHhSzKK4O7H/LjCbpBM4VJvmjQptCLPBmYekLGWpt/GISM9EEB6GZZ94I6BV191AAwGGjAYWXoywJgZpmWImXQXDcwJ+cX2p3WrRMGWF6MFWHaKddK2nbatx9O++m1H+//5/8LzCw8IyeUP9gAAAAASUVORK5CYII=" alt="Question" /><br />How does the clustering looks like when only resistance genes are taken into account? What does it tell you?</p>
<h2 id="bonus-characterization-of-differentially-expressed-genes">Bonus: characterization of differentially expressed genes</h2>
<h3 id="manually">Manually</h3>
<p>Because there are relatively few genes differentially expressed between resistant and susceptible lines, it is possible to look them up in reference databases (Ensembl, Uniprot, Flybase). But this long, subjective, and because there are a lot of uncharacterized genes, it is often frustrating...</p>
<h3 id="go-enrichment-test">GO enrichment test</h3>
<p>To get an objective view of what are the genes in a long lists of genes, and to characterize their function, Gene Ontology (GO) enrichment analyses are useful. For each GO category (a group of genes sharing the same function, involved in the same process, or located in the same cellular compartment) it is possible to test whether the proportion of DE genes is higher then expected. You can do this with the <code>topGO</code> package.</p>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAABgAAAAYABaOP7tAAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAHKSURBVFiFxZbBSgJRFIa/6yjtxBB9gEACEQl8gFZBgYgg7XoAF0JPEBS1DnetfIp20SsEiRBR+AKBRJsWppwW3YFJ7oz3Xkc98MPMnHv+8/9n7nhVIsI2I+tbqJRSQEPfPomvExHxAjAARGPgzePZvBNpHqKzEQHADjA2CBgDO658GY+3dg7sGZ7v6ZxbOLovA18G9yG+gPI6J3AN5BPyeb0m/QkAdWCW4D7EDKinvgmBx4VGH8ANcAd8L+QeUxUAtAxO25H8pSHfSkUAkAPeDA2CyJqGIf8G5NLYhD2gYtg788jtfDGva3pL2Ze4LwKfBneysO7AtEbXFleZwBVQWOoiPgqaIz4S3FeBnxhnthMQzVH1mcAtKxzXkchqLnPEuD9JcOQ6gRAnVp+hVvxiQViL1JxZrH8BsjYCehZkAjwANeDQUrAAvUQBwC4wsSTzwQTYTRLQX2PzEH2jAGAfmDoQvQKnGq8OdVNg3yTg3tFJ9DBqO9be//sdUEodAU3cYhpzbRNN3ROAABg5OhBgCBxpDD3qR7o3XY/itNDFU31aGGaAUvyrWnuUAv7+RB5vScCFEhGUUhX+DpRgQ43nwLOIvCv9HW8tfgFqVoEjNYWunQAAAABJRU5ErkJggg==" alt="Warning" /><br />A word of caution for the use of such tools:</p>
<ul class="incremental">
<li>They can be very sensitive to the set of genes used as background/universe. In this practical, you pre-filtered genes before DE analysis, so the list of genes that were actually tested should be used as universe.<br /></li>
<li>Another problem when applying such tests to a list of DE genes is a potential length bias. There will be more RNA-seq reads for long genes, so more power to detect DE for longer genes. This can confound the ontology enrichment tests which will report functional biases associated to longer genes.<br /></li>
<li>Since the GO categories are not independent, it is debated whether a mutiple testing correction (such as FDR) is appropriate. There is a nice paragraph on that topic in the <code>topGO</code> package documentation.</li>
</ul>
<pre class="sourceCode R"><code class="sourceCode r"><span class="kw">library</span>(topGO)

## topGO needs a vector with 0 or 1 values depending if a gene is DE or not
geneList &lt;-<span class="st"> </span>(<span class="kw">rep</span>(<span class="dv">0</span>, <span class="dt">times=</span><span class="kw">length</span>(<span class="kw">rownames</span>(results))))
<span class="kw">names</span>(geneList) &lt;-<span class="st"> </span><span class="kw">rownames</span>(results)
DEGenes &lt;-<span class="st"> </span><span class="kw">row.names</span>(treatmentGenes)
geneList[DEGenes] &lt;-<span class="st"> </span><span class="dv">1</span>
geneList =<span class="st"> </span><span class="kw">as.factor</span>(geneList)
<span class="kw">summary</span>(geneList)

## You then need a mapping of genes to the GO categories. This can be retrieved from Ensembl using biomaRt, 
## or using the Drosophila melanogaster annotation package in Bioconductor
## If the annotation package is not installed: 
## source(&quot;http://bioconductor.org/biocLite.R&quot;)
## biocLite(&quot;org.Dm.eg.db&quot;)
<span class="kw">library</span>(org.Dm.eg.db)
## Build the topGO object for biological process ontology
BPdata &lt;-<span class="st"> </span><span class="kw">new</span>(<span class="st">&quot;topGOdata&quot;</span>,
              <span class="dt">ontology=</span><span class="st">&quot;BP&quot;</span>,
              <span class="dt">allGenes =</span> geneList,
              <span class="dt">nodeSize =</span> <span class="dv">5</span>,
              <span class="dt">annot =</span> annFUN.org,
              <span class="dt">mapping =</span> <span class="st">&quot;org.Dm.eg.db&quot;</span>,
              <span class="dt">ID =</span> <span class="st">&quot;Ensembl&quot;</span>)
resultBP &lt;-<span class="st"> </span><span class="kw">runTest</span>(BPdata, <span class="dt">algorithm =</span> <span class="st">&quot;classic&quot;</span>, <span class="dt">statistic =</span> <span class="st">&quot;fisher&quot;</span>)
myTable &lt;-<span class="st"> </span><span class="kw">GenTable</span>(BPdata, <span class="dt">classic =</span> resultBP, <span class="dt">topNodes=</span><span class="kw">length</span>(BPdata@graph@nodes), <span class="dt">numChar=</span><span class="dv">100</span>)
<span class="kw">head</span>(myTable)</code></pre>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAA7AAAAOwBeShxvQAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAJGSURBVFiFxZc7aBVBFEDPjc+ACn6wEfJR/EBAKxE1xg/YiHY2Bq1UsBV7QbBUlDSS1FYiEtBC0UJfDGga0U4t/GvjB+QZFMTPtXizOF5mdmb3Bd/ALd7uvfec3dk3syuqSjdHT1fpnQiIiGTk9IjIThHZGE1S1dIAlgDDwFHgHHADeAl8A64CQ5G63cBrQF3cD+YFCnuB08AxoOk1iMUboGF6jAK/TN7tpICDX8uA+nHT9NgBfLdwYGGOwHhFeNM2Bi6ZnHsxeEjgQgX4FLDI1AvwyeQdCUyzAMeBPv/gWuBtJnzawl2PZYHch8BSAy/u9EQd+Ge/oREYjNQ8cHI+XIH3VeFFXME8+U5gU0nNR+CJOTYJ8LgiPCgBrAgAUrEH4GJNgUJiXk342WIfarhGsUS7oPgxVhN+6p+/YYnEXWAD8Kom/CswA9wCLgMngHXBdSAg0cT91YBVRiIHPgtsT+415iluABO0VzO7whUSufCRFDy4GSV2xuUZ8C+5cFWt/D4w303NUOT8LLAXQEQaWR0rXH3OlW8DDgA/iCxWtaagAnwU+OkdT0rMFXwYOGjgWRKdwlsOvj8CT0p0DHe5/cCzktyoRAzeS/km1QK2mpoB4HlC4mSuwCFXcAbYB3wogxuJFyUC7+xdiAlMuoI+87sFbEk8N4MJidU5Aof5uxmdp/2Wm4R79StpfztY+HTuFCwA7niFj4DNOXAjcR347Xo8BXbZPHHJwSEi64HFqjoTTUoMEVkDDKjqVPB8mcD/GF3/Ov4D9/4Ax5qPrMMAAAAASUVORK5CYII=" alt="To do" /><br />If you have time you can run the GO enrichment test on the molecular function (<code>ontology=&quot;MF&quot;</code>) or the cellular component ontologies (<code>ontology=&quot;CC&quot;</code>).</p>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAAA3NCSVQICAjb4U/gAAAACXBIWXMAAAEbAAABGwGN907lAAAAGXRFWHRTb2Z0d2FyZQB3d3cuaW5rc2NhcGUub3Jnm+48GgAAALRQTFRF////AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAokSIKwAAADt0Uk5TAAEDBgcICQsMDhATFRcbHSEkJS0uNj5BQkVJU1hfYnN9lZaXmJynwcTGzM/a3+Dh4uXm6O3x8vP1+PpY7DV9AAABVUlEQVQ4y4VTW1uCQBA9KpZiZniBQiwCFLANIZG1zv//Xz3I6qL1MU97Zuc+Z4CzGG4UCylFHLkGbmUcVDxLFYyvvnu+JIvQsy3L9sKClH6v4Z6QqdNRsOOkZKIFmeUsl82Qy5L57OyfU0yva5oK5nWMXkIxuq16JJic6vBZKv/haxC8DlWMkj4AjCVVfntHkjtb1UE5BhAwrRWTA4/r9ZGHSa1IGQBGRafGG25NwNxyUyscVgZcFqr/PVcAsOJezaOgi4hhDfvfZR8AHsn7WhUyQkxPNfa8AAC88UtpPMYQtJv9Lz75rt42BSQt/dvbkvsHhSzKK4O7H/LjCbpBM4VJvmjQptCLPBmYekLGWpt/GISM9EEB6GZZ94I6BV191AAwGGjAYWXoywJgZpmWImXQXDcwJ+cX2p3WrRMGWF6MFWHaKddK2nbatx9O++m1H+//5/8LzCw8IyeUP9gAAAAASUVORK5CYII=" alt="Question" /><br />What are the top categories enriched for genes DE with treatment? Is it consistent with what is reported in the original paper<a href="./myTable.txt">?</a></p>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAAuQAAALkB4qdB6AAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAMxSURBVFiFvZfNS5RRFMZ/Z2YIPxPCKBEyUAQ3gvQlrQInWrQQgoSWLXQVWCH9Ca1atPBPqAgSXEsSIglRCi4Cg0RmM5pYUYr4UXhavOdlrnfu+zpvWAcOM/Occ57zzJn73ntHVBURmQYOgNuq+pN/aCLSArwCcqpaLBh+AFwHpkTkRpoIETkJXAQuAZcNfg98AOZVdfOI5lPAFeA1AKoK0AK8A9ReG1QV14Eu4I2J1QQ/sJyuQH2D16NFVXETXBFFB88B94Fti60Az4BR4Kr5qGErlrNtWM7hKfrNDwlwVBaBvH1uBGatcBd4FMdCDuQtZ9dqZoFGJ1b0pxskcgjHjWge6EnL9ep6rEaB8dTcFJIB+03XgdZamzv1rVZ7AAxkEgA0AyX7BreyNnd4bhlHCWjOImDECl/+bXOH66VxjYTiOcJ2wV6fJ8SzWMxxIRQ8SsDCMQiIOYICxMZUAUROAFvAd1VtOwYBiMgacIpoHey7sdAEOoATwPJxNDdbNs4OP1CozqXsCKkyETkDJE1mTVXXA3jMVa6KJKzcVaKV2+Th56hsySHfBs55NU0WWw31Ck0A4KN9y35g2sE3qUxtAdiw96eJFlnBclzrdzir7YgNZC4Qm7DYAwd7YNhEIH+OlA0tSUAO+GyFg17spuGTDjZp2E0vd9Dwzzgn45ECrHjIijeAXgfPEz2m3wAx/2ZY3snrtVoFhjKdBQ7JYyP4CvQ5eHzunzJXYMWJ91mNAo9Te3gN24F7QL19FuCFEe0AT4kW54JhZ83VsDbL2THsBZXNrt6424MCgPNUTsCiJ2zYRhwL+WHv75qrYXHjLWDY44hvRCXg/CEBXvNXBG49QDfJz7/v3YH6vHEfEhEHF53mhYT1UGc5ZeAa0ZH9xHzEsLLl1CVwFBwRi+5G9Jbo/vZQVX+Tbr9UdQaY8QMi8iutUFV/i8gdYI34HEpboQkTKKXklNImEPKk+8B/s6SzIM3aReRTUiwrWdWFJDFRpI7oMavF6lV1t5bELD/BHtHFYg/oJNpYXO/0cmqzWheLTWqMaJHtA18837fYWCbOjAIaiP4nLlG9+SxZrOqPbZr/Acin3r66y1JbAAAAAElFTkSuQmCC" alt="Tip" /><br /><code>TopGO</code> includes the possibility to use several decorrelation algorithms, giving less redundant, and more precise categories in the results. Repeat the analysis with the weight algorithm (<code>algorithm = &quot;weight&quot;</code>), and observe the difference in results.</p>
<h3 id="topanat-enrichment-test">topAnat enrichment test</h3>
<p>It is possible to perform a similar ontology enrichment, but on the fly anatomical ontology instead of Gene Ontology. Genes are mapped to a tissue if some expression was detected in this tissue. With the Bgee database team (<a href="http://bgee.org">http://bgee.org</a>), I have developped a tool called <code>BgeeDB</code> allowing to do this, based on the <code>topGO</code> package algorithm. It is available in Bioconductor (release 3.3), or on GitHub <a href="https://github.com/BgeeDB/BgeeDB_R">https://github.com/BgeeDB/BgeeDB_R</a>. I encourage you to try in addition to the classical GO enrichment tests, it gives very interesting results! A graphical interface is also available at <a href="http://bgee.org/?page=top_anat#/">http://bgee.org/?page=top_anat#/</a>.</p>
<pre class="sourceCode R"><code class="sourceCode r">## As BgeeDB was not yet available on R/Bioc 3.2, install it from the source code, already in the data folder
<span class="kw">install.packages</span>(<span class="kw">file.path</span>(dataFolder, <span class="st">&quot;./BgeeDB-master&quot;</span>), <span class="dt">repos =</span> <span class="ot">NULL</span>, <span class="dt">type=</span><span class="st">&quot;source&quot;</span>)
<span class="kw">library</span>(BgeeDB)

## Loading calls of expression. This requires an internet connection
myTopAnatData &lt;-<span class="st"> </span><span class="kw">loadTopAnatData</span>(<span class="dt">species=</span><span class="dv">7227</span>)
## Note: a particular data type could be selected. For D. melanogaster, Bgee has integarted 
## Affymetrix, RNA-seq, EST and in situ hybridization data
## Look at the data:
<span class="kw">lapply</span>(myTopAnatData, head)

## To perform the anatomical ontology enrichment test, you can readily 
## use the same gene list as used previously for topGO test
myTopAnatObject &lt;-<span class="st">  </span><span class="kw">topAnat</span>(myTopAnatData, geneList)

## run the test
resultsAnatomy &lt;-<span class="st"> </span><span class="kw">runTest</span>(myTopAnatObject, <span class="dt">algorithm =</span> <span class="st">'classic'</span>, <span class="dt">statistic =</span> <span class="st">'fisher'</span>)
## Warning: This can be long especially if decorrelation algorithms are used, because the anatomical 
## ontology is bigger than the Gene Ontology. Consider running a script in batch mode if you have
## multiple analyses to do.

## Format the table of results, only displaying results significant at a 10% FDR threshold
myTableAnatomy &lt;-<span class="st"> </span><span class="kw">makeTable</span>(myTopAnatData, myTopAnatObject, resultsAnatomy, <span class="fl">0.1</span>)</code></pre>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAAA3NCSVQICAjb4U/gAAAACXBIWXMAAAEbAAABGwGN907lAAAAGXRFWHRTb2Z0d2FyZQB3d3cuaW5rc2NhcGUub3Jnm+48GgAAALRQTFRF////AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAokSIKwAAADt0Uk5TAAEDBgcICQsMDhATFRcbHSEkJS0uNj5BQkVJU1hfYnN9lZaXmJynwcTGzM/a3+Dh4uXm6O3x8vP1+PpY7DV9AAABVUlEQVQ4y4VTW1uCQBA9KpZiZniBQiwCFLANIZG1zv//Xz3I6qL1MU97Zuc+Z4CzGG4UCylFHLkGbmUcVDxLFYyvvnu+JIvQsy3L9sKClH6v4Z6QqdNRsOOkZKIFmeUsl82Qy5L57OyfU0yva5oK5nWMXkIxuq16JJic6vBZKv/haxC8DlWMkj4AjCVVfntHkjtb1UE5BhAwrRWTA4/r9ZGHSa1IGQBGRafGG25NwNxyUyscVgZcFqr/PVcAsOJezaOgi4hhDfvfZR8AHsn7WhUyQkxPNfa8AAC88UtpPMYQtJv9Lz75rt42BSQt/dvbkvsHhSzKK4O7H/LjCbpBM4VJvmjQptCLPBmYekLGWpt/GISM9EEB6GZZ94I6BV191AAwGGjAYWXoywJgZpmWImXQXDcwJ+cX2p3WrRMGWF6MFWHaKddK2nbatx9O++m1H+//5/8LzCw8IyeUP9gAAAAASUVORK5CYII=" alt="Question" /><br />What are the anatomical structures enriched for expression of DE genes? How does it relate to the GO enrichment results<a href="./myTableAnatomy.txt">?</a></p>
<h2 id="bonus-2-link-to-patterns-of-sequence-evolution">Bonus 2: link to patterns of sequence evolution</h2>
<p>In population genomics studies, a major aim is often to demonstrate that a difference across individuals or across populations evolved under the action of positive selection, and is likely involved in some adaption. This is difficult to do with differential expression results because gene expression is a continuous character: it is hard to formulate a neutral model of evolution to use a null hypothesis. Many expression changes are likely to be neutral. Worse, it is difficult to pinpoint the precise genes onw hich selection could have acted since numerous expression changes could occur on genes that are regulated downstream of the causal/affected genes.</p>
<p>Thus it is nice to connect patterns of differential expression to patterns of sequence evolution. The analysis of sequence substitutions is a mature field, and there are numerous measures to detect positive selection on sequences. A significant expression change of a gene whose sequence experienced positive selection is a conspicuous evidence for the biological signficance of this gene.</p>
<p>Regarding the dataset you analyzed for this practical, have a look at the popDrowser <a href="http://popdrowser.uab.cat/">http://popdrowser.uab.cat/</a>, which provides a wide range of diversity/variation/selection measures across the <em>D. melanogaster</em> genome, calculated using the same DGRP lines.</p>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAAA3NCSVQICAjb4U/gAAAACXBIWXMAAAEbAAABGwGN907lAAAAGXRFWHRTb2Z0d2FyZQB3d3cuaW5rc2NhcGUub3Jnm+48GgAAALRQTFRF////AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAokSIKwAAADt0Uk5TAAEDBgcICQsMDhATFRcbHSEkJS0uNj5BQkVJU1hfYnN9lZaXmJynwcTGzM/a3+Dh4uXm6O3x8vP1+PpY7DV9AAABVUlEQVQ4y4VTW1uCQBA9KpZiZniBQiwCFLANIZG1zv//Xz3I6qL1MU97Zuc+Z4CzGG4UCylFHLkGbmUcVDxLFYyvvnu+JIvQsy3L9sKClH6v4Z6QqdNRsOOkZKIFmeUsl82Qy5L57OyfU0yva5oK5nWMXkIxuq16JJic6vBZKv/haxC8DlWMkj4AjCVVfntHkjtb1UE5BhAwrRWTA4/r9ZGHSa1IGQBGRafGG25NwNxyUyscVgZcFqr/PVcAsOJezaOgi4hhDfvfZR8AHsn7WhUyQkxPNfa8AAC88UtpPMYQtJv9Lz75rt42BSQt/dvbkvsHhSzKK4O7H/LjCbpBM4VJvmjQptCLPBmYekLGWpt/GISM9EEB6GZZ94I6BV191AAwGGjAYWXoywJgZpmWImXQXDcwJ+cX2p3WrRMGWF6MFWHaKddK2nbatx9O++m1H+//5/8LzCw8IyeUP9gAAAAASUVORK5CYII=" alt="Question" /><br />Look at the different tracks available on this website. Are you familiar with them? Which ones would be most appropriate to search for positive selection on coding sequences? What about regulatory sequences nearby genes?</p>
<p>If you are interested by a particular gene, you can easily visualize the sequence variation patterns in and around this genes. This could be useful to illustrate a talk or for a paper figure. If you want to download the preprocessed data across the whole genome, this seems possible but the website is not very user friendly :( I have found two main ways:</p>
<ul class="incremental">
<li>Use <code>Select Tracks</code> to choose to display the measures of interest. Go back to the visualization page and for the corresponding track, you can click on a small floppy disk downlaod icon, and retrieve a ggf3 with the data. Unfortunately this does not seem to be working for all tracks (probably some bug, I wrote to the authors). Some tracks work fine, for example the McDonald-Kreitman test track.</li>
</ul>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAAA3NCSVQICAjb4U/gAAAACXBIWXMAAAEbAAABGwGN907lAAAAGXRFWHRTb2Z0d2FyZQB3d3cuaW5rc2NhcGUub3Jnm+48GgAAALRQTFRF////AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAokSIKwAAADt0Uk5TAAEDBgcICQsMDhATFRcbHSEkJS0uNj5BQkVJU1hfYnN9lZaXmJynwcTGzM/a3+Dh4uXm6O3x8vP1+PpY7DV9AAABVUlEQVQ4y4VTW1uCQBA9KpZiZniBQiwCFLANIZG1zv//Xz3I6qL1MU97Zuc+Z4CzGG4UCylFHLkGbmUcVDxLFYyvvnu+JIvQsy3L9sKClH6v4Z6QqdNRsOOkZKIFmeUsl82Qy5L57OyfU0yva5oK5nWMXkIxuq16JJic6vBZKv/haxC8DlWMkj4AjCVVfntHkjtb1UE5BhAwrRWTA4/r9ZGHSa1IGQBGRafGG25NwNxyUyscVgZcFqr/PVcAsOJezaOgi4hhDfvfZR8AHsn7WhUyQkxPNfa8AAC88UtpPMYQtJv9Lz75rt42BSQt/dvbkvsHhSzKK4O7H/LjCbpBM4VJvmjQptCLPBmYekLGWpt/GISM9EEB6GZZ94I6BV191AAwGGjAYWXoywJgZpmWImXQXDcwJ+cX2p3WrRMGWF6MFWHaKddK2nbatx9O++m1H+//5/8LzCw8IyeUP9gAAAAASUVORK5CYII=" alt="Question" /><br />Since this is a gene-based measure, it could be interesting to compare the neutrality index of DE genes vs. non-DE genes.</p>
<ul class="incremental">
<li>If you zoom out and visualize a whole chromosome, it is possible to chosse <code>(DGRP) On-the-fly Variation Estimates Download</code> from the drop-down menu, click on <code>Configure</code> to select the measure of interest and the window size, and then <code>Go</code> to get the results for this chromosome.</li>
</ul>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAA7AAAAOwBeShxvQAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAJGSURBVFiFxZc7aBVBFEDPjc+ACn6wEfJR/EBAKxE1xg/YiHY2Bq1UsBV7QbBUlDSS1FYiEtBC0UJfDGga0U4t/GvjB+QZFMTPtXizOF5mdmb3Bd/ALd7uvfec3dk3syuqSjdHT1fpnQiIiGTk9IjIThHZGE1S1dIAlgDDwFHgHHADeAl8A64CQ5G63cBrQF3cD+YFCnuB08AxoOk1iMUboGF6jAK/TN7tpICDX8uA+nHT9NgBfLdwYGGOwHhFeNM2Bi6ZnHsxeEjgQgX4FLDI1AvwyeQdCUyzAMeBPv/gWuBtJnzawl2PZYHch8BSAy/u9EQd+Ge/oREYjNQ8cHI+XIH3VeFFXME8+U5gU0nNR+CJOTYJ8LgiPCgBrAgAUrEH4GJNgUJiXk342WIfarhGsUS7oPgxVhN+6p+/YYnEXWAD8Kom/CswA9wCLgMngHXBdSAg0cT91YBVRiIHPgtsT+415iluABO0VzO7whUSufCRFDy4GSV2xuUZ8C+5cFWt/D4w303NUOT8LLAXQEQaWR0rXH3OlW8DDgA/iCxWtaagAnwU+OkdT0rMFXwYOGjgWRKdwlsOvj8CT0p0DHe5/cCzktyoRAzeS/km1QK2mpoB4HlC4mSuwCFXcAbYB3wogxuJFyUC7+xdiAlMuoI+87sFbEk8N4MJidU5Aof5uxmdp/2Wm4R79StpfztY+HTuFCwA7niFj4DNOXAjcR347Xo8BXbZPHHJwSEi64HFqjoTTUoMEVkDDKjqVPB8mcD/GF3/Ov4D9/4Ax5qPrMMAAAAASUVORK5CYII=" alt="To do" /><br />If you have some time left, try playing around these measures and link them to your DE results. Good luck (and congrats if you went that far)!</p>
<hr />
<p><sub>Icons taken from <a href="http://www.flaticon.com/">http://www.flaticon.com/</a></sub></p>
<p><sub>Thanks to Amina Echchiki for proofreading and testing</sub></p>
<!--
* TO DO: how to implement code folding/hiding? Easiest is probably to have 2 versions, one with code, one without... Or change file names to generic file names?

* TO DO: prepare short presentation of: 
  * kallisto. Fast + accurate: game changer
  * DTU/DE/DTE. DE confounded by DTU
  * limma-voom on TPM, etc

![Question](round-help-button.png)
![Tip](elemental-tip.png)
![To do](wrench-and-hammer.png)
![Warning](warning.png)
http://www.emoji-cheat-sheet.com/
-->
Example footer:
<small>Copyright 2016 <a href="https://github.com/wurmlab/genomicscourse/graphs/contributors">Authors</a> - <a href="http://creativecommons.org/licenses/by/4.0/">CC-BY license</a></small>
</body>
</html>
